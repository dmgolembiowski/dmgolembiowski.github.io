<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<title>:mod:`ssl` --- TLS/SSL wrapper for socket objects</title>
<style type="text/css">

/*
:Author: David Goodger (goodger@python.org)
:Id: $Id: html4css1.css 7952 2016-07-26 18:15:59Z milde $
:Copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.

See http://docutils.sf.net/docs/howto/html-stylesheets.html for how to
customize this style sheet.
*/

/* used to remove borders from tables and images */
.borderless, table.borderless td, table.borderless th {
  border: 0 }

table.borderless td, table.borderless th {
  /* Override padding for "table.docutils td" with "! important".
     The right padding separates the table cells. */
  padding: 0 0.5em 0 0 ! important }

.first {
  /* Override more specific margin styles with "! important". */
  margin-top: 0 ! important }

.last, .with-subtitle {
  margin-bottom: 0 ! important }

.hidden {
  display: none }

.subscript {
  vertical-align: sub;
  font-size: smaller }

.superscript {
  vertical-align: super;
  font-size: smaller }

a.toc-backref {
  text-decoration: none ;
  color: black }

blockquote.epigraph {
  margin: 2em 5em ; }

dl.docutils dd {
  margin-bottom: 0.5em }

object[type="image/svg+xml"], object[type="application/x-shockwave-flash"] {
  overflow: hidden;
}

/* Uncomment (and remove this text!) to get bold-faced definition list terms
dl.docutils dt {
  font-weight: bold }
*/

div.abstract {
  margin: 2em 5em }

div.abstract p.topic-title {
  font-weight: bold ;
  text-align: center }

div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em ;
  border: medium outset ;
  padding: 1em }

div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title {
  font-weight: bold ;
  font-family: sans-serif }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title, .code .error {
  color: red ;
  font-weight: bold ;
  font-family: sans-serif }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/

div.dedication {
  margin: 2em 5em ;
  text-align: center ;
  font-style: italic }

div.dedication p.topic-title {
  font-weight: bold ;
  font-style: normal }

div.figure {
  margin-left: 2em ;
  margin-right: 2em }

div.footer, div.header {
  clear: both;
  font-size: smaller }

div.line-block {
  display: block ;
  margin-top: 1em ;
  margin-bottom: 1em }

div.line-block div.line-block {
  margin-top: 0 ;
  margin-bottom: 0 ;
  margin-left: 1.5em }

div.sidebar {
  margin: 0 0 0.5em 1em ;
  border: medium outset ;
  padding: 1em ;
  background-color: #ffffee ;
  width: 40% ;
  float: right ;
  clear: right }

div.sidebar p.rubric {
  font-family: sans-serif ;
  font-size: medium }

div.system-messages {
  margin: 5em }

div.system-messages h1 {
  color: red }

div.system-message {
  border: medium outset ;
  padding: 1em }

div.system-message p.system-message-title {
  color: red ;
  font-weight: bold }

div.topic {
  margin: 2em }

h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em }

h1.title {
  text-align: center }

h2.subtitle {
  text-align: center }

hr.docutils {
  width: 75% }

img.align-left, .figure.align-left, object.align-left, table.align-left {
  clear: left ;
  float: left ;
  margin-right: 1em }

img.align-right, .figure.align-right, object.align-right, table.align-right {
  clear: right ;
  float: right ;
  margin-left: 1em }

img.align-center, .figure.align-center, object.align-center {
  display: block;
  margin-left: auto;
  margin-right: auto;
}

table.align-center {
  margin-left: auto;
  margin-right: auto;
}

.align-left {
  text-align: left }

.align-center {
  clear: both ;
  text-align: center }

.align-right {
  text-align: right }

/* reset inner alignment in figures */
div.align-right {
  text-align: inherit }

/* div.align-center * { */
/*   text-align: left } */

.align-top    {
  vertical-align: top }

.align-middle {
  vertical-align: middle }

.align-bottom {
  vertical-align: bottom }

ol.simple, ul.simple {
  margin-bottom: 1em }

ol.arabic {
  list-style: decimal }

ol.loweralpha {
  list-style: lower-alpha }

ol.upperalpha {
  list-style: upper-alpha }

ol.lowerroman {
  list-style: lower-roman }

ol.upperroman {
  list-style: upper-roman }

p.attribution {
  text-align: right ;
  margin-left: 50% }

p.caption {
  font-style: italic }

p.credits {
  font-style: italic ;
  font-size: smaller }

p.label {
  white-space: nowrap }

p.rubric {
  font-weight: bold ;
  font-size: larger ;
  color: maroon ;
  text-align: center }

p.sidebar-title {
  font-family: sans-serif ;
  font-weight: bold ;
  font-size: larger }

p.sidebar-subtitle {
  font-family: sans-serif ;
  font-weight: bold }

p.topic-title {
  font-weight: bold }

pre.address {
  margin-bottom: 0 ;
  margin-top: 0 ;
  font: inherit }

pre.literal-block, pre.doctest-block, pre.math, pre.code {
  margin-left: 2em ;
  margin-right: 2em }

pre.code .ln { color: grey; } /* line numbers */
pre.code, code { background-color: #eeeeee }
pre.code .comment, code .comment { color: #5C6576 }
pre.code .keyword, code .keyword { color: #3B0D06; font-weight: bold }
pre.code .literal.string, code .literal.string { color: #0C5404 }
pre.code .name.builtin, code .name.builtin { color: #352B84 }
pre.code .deleted, code .deleted { background-color: #DEB0A1}
pre.code .inserted, code .inserted { background-color: #A3D289}

span.classifier {
  font-family: sans-serif ;
  font-style: oblique }

span.classifier-delimiter {
  font-family: sans-serif ;
  font-weight: bold }

span.interpreted {
  font-family: sans-serif }

span.option {
  white-space: nowrap }

span.pre {
  white-space: pre }

span.problematic {
  color: red }

span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80% }

table.citation {
  border-left: solid 1px gray;
  margin-left: 1px }

table.docinfo {
  margin: 2em 4em }

table.docutils {
  margin-top: 0.5em ;
  margin-bottom: 0.5em }

table.footnote {
  border-left: solid 1px black;
  margin-left: 1px }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {
  padding-left: 0.5em ;
  padding-right: 0.5em ;
  vertical-align: top }

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: bold ;
  text-align: left ;
  white-space: nowrap ;
  padding-left: 0 }

/* "booktabs" style (no vertical lines) */
table.docutils.booktabs {
  border: 0px;
  border-top: 2px solid;
  border-bottom: 2px solid;
  border-collapse: collapse;
}
table.docutils.booktabs * {
  border: 0px;
}
table.docutils.booktabs th {
  border-bottom: thin solid;
  text-align: left;
}

h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {
  font-size: 100% }

ul.auto-toc {
  list-style-type: none }

</style>
</head>
<body>
<div class="document" id="mod-ssl-tls-ssl-wrapper-for-socket-objects">
<h1 class="title"><a href="#id1"><span class="problematic" id="id2">:mod:`ssl`</span></a> --- TLS/SSL wrapper for socket objects</h1>

<div class="system-message" id="id1">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1); <em><a href="#id2">backlink</a></em></p>
Unknown interpreted text role &quot;mod&quot;.</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 4)</p>
<p>Unknown directive type &quot;module&quot;.</p>
<pre class="literal-block">
.. module:: ssl
   :synopsis: TLS/SSL wrapper for socket objects

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 7)</p>
<p>Unknown directive type &quot;moduleauthor&quot;.</p>
<pre class="literal-block">
.. moduleauthor:: Bill Janssen &lt;bill.janssen&#64;gmail.com&gt;
</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 8)</p>
<p>Unknown directive type &quot;sectionauthor&quot;.</p>
<pre class="literal-block">
.. sectionauthor::  Bill Janssen &lt;bill.janssen&#64;gmail.com&gt;

</pre>
</div>
<p><strong>Source code:</strong> <a href="#id3"><span class="problematic" id="id4">:source:`Lib/ssl.py`</span></a></p>
<div class="system-message" id="id3">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 10); <em><a href="#id4">backlink</a></em></p>
Unknown interpreted text role &quot;source&quot;.</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 12)</p>
<p>Unknown directive type &quot;index&quot;.</p>
<pre class="literal-block">
.. index:: single: OpenSSL; (use in module ssl)

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 14)</p>
<p>Unknown directive type &quot;index&quot;.</p>
<pre class="literal-block">
.. index:: TLS, SSL, Transport Layer Security, Secure Sockets Layer

</pre>
</div>
<hr class="docutils" />
<p>This module provides access to Transport Layer Security (often known as &quot;Secure
Sockets Layer&quot;) encryption and peer authentication facilities for network
sockets, both client-side and server-side.  This module uses the OpenSSL
library. It is available on all modern Unix systems, Windows, Mac OS X, and
probably additional platforms, as long as OpenSSL is installed on that platform.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Some behavior may be platform dependent, since calls are made to the
operating system socket APIs.  The installed version of OpenSSL may also
cause variations in behavior. For example, TLSv1.1 and TLSv1.2 come with
openssl version 1.0.1.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>Don't use this module without reading the <a href="#id5"><span class="problematic" id="id6">:ref:`ssl-security`</span></a>.  Doing so
may lead to a false sense of security, as the default settings of the
ssl module are not necessarily appropriate for your application.</p>
<div class="last system-message" id="id5">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 32); <em><a href="#id6">backlink</a></em></p>
Unknown interpreted text role &quot;ref&quot;.</div>
</div>
<p>This section documents the objects and functions in the <tt class="docutils literal">ssl</tt> module; for more
general information about TLS, SSL, and certificates, the reader is referred to
the documents in the &quot;See Also&quot; section at the bottom.</p>
<p>This module provides a class, <a href="#id7"><span class="problematic" id="id8">:class:`ssl.SSLSocket`</span></a>, which is derived from the
<a href="#id9"><span class="problematic" id="id10">:class:`socket.socket`</span></a> type, and provides a socket-like wrapper that also
encrypts and decrypts the data going over the socket with SSL.  It supports
additional methods such as <a href="#id11"><span class="problematic" id="id12">:meth:`getpeercert`</span></a>, which retrieves the
certificate of the other side of the connection, and <a href="#id13"><span class="problematic" id="id14">:meth:`cipher`</span></a>, which
retrieves the cipher being used for the secure connection.</p>
<div class="system-message" id="id7">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 41); <em><a href="#id8">backlink</a></em></p>
Unknown interpreted text role &quot;class&quot;.</div>
<div class="system-message" id="id9">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 41); <em><a href="#id10">backlink</a></em></p>
Unknown interpreted text role &quot;class&quot;.</div>
<div class="system-message" id="id11">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 41); <em><a href="#id12">backlink</a></em></p>
Unknown interpreted text role &quot;meth&quot;.</div>
<div class="system-message" id="id13">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 41); <em><a href="#id14">backlink</a></em></p>
Unknown interpreted text role &quot;meth&quot;.</div>
<p>For more sophisticated applications, the <a href="#id15"><span class="problematic" id="id16">:class:`ssl.SSLContext`</span></a> class
helps manage settings and certificates, which can then be inherited
by SSL sockets created through the <a href="#id17"><span class="problematic" id="id18">:meth:`SSLContext.wrap_socket`</span></a> method.</p>
<div class="system-message" id="id15">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 48); <em><a href="#id16">backlink</a></em></p>
Unknown interpreted text role &quot;class&quot;.</div>
<div class="system-message" id="id17">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 48); <em><a href="#id18">backlink</a></em></p>
Unknown interpreted text role &quot;meth&quot;.</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 52)</p>
<p>Unknown directive type &quot;versionchanged&quot;.</p>
<pre class="literal-block">
.. versionchanged:: 3.5.3
   Updated to support linking with OpenSSL 1.1.0

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 55)</p>
<p>Unknown directive type &quot;versionchanged&quot;.</p>
<pre class="literal-block">
.. versionchanged:: 3.6

   OpenSSL 0.9.8, 1.0.0 and 1.0.1 are deprecated and no longer supported.
   In the future the ssl module will require at least OpenSSL 1.0.2 or
   1.1.0.


</pre>
</div>
<div class="section" id="functions-constants-and-exceptions">
<h1>Functions, Constants, and Exceptions</h1>
<div class="section" id="socket-creation">
<h2>Socket creation</h2>
<p>Since Python 3.2 and 2.7.9, it is recommended to use the
<a href="#id19"><span class="problematic" id="id20">:meth:`SSLContext.wrap_socket`</span></a> of an <a href="#id21"><span class="problematic" id="id22">:class:`SSLContext`</span></a> instance to wrap
sockets as <a href="#id23"><span class="problematic" id="id24">:class:`SSLSocket`</span></a> objects. The helper functions
<a href="#id25"><span class="problematic" id="id26">:func:`create_default_context`</span></a> returns a new context with secure default
settings. The old <a href="#id27"><span class="problematic" id="id28">:func:`wrap_socket`</span></a> function is deprecated since it is
both inefficient and has no support for server name indication (SNI) and
hostname matching.</p>
<div class="system-message" id="id19">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 69); <em><a href="#id20">backlink</a></em></p>
Unknown interpreted text role &quot;meth&quot;.</div>
<div class="system-message" id="id21">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 69); <em><a href="#id22">backlink</a></em></p>
Unknown interpreted text role &quot;class&quot;.</div>
<div class="system-message" id="id23">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 69); <em><a href="#id24">backlink</a></em></p>
Unknown interpreted text role &quot;class&quot;.</div>
<div class="system-message" id="id25">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 69); <em><a href="#id26">backlink</a></em></p>
Unknown interpreted text role &quot;func&quot;.</div>
<div class="system-message" id="id27">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 69); <em><a href="#id28">backlink</a></em></p>
Unknown interpreted text role &quot;func&quot;.</div>
<p>Client socket example with default context and IPv4/IPv6 dual stack:</p>
<pre class="literal-block">
import socket
import ssl

hostname = 'www.python.org'
context = ssl.create_default_context()

with socket.create_connection((hostname, 443)) as sock:
    with context.wrap_socket(sock, server_hostname=hostname) as ssock:
        print(ssock.version())
</pre>
<p>Client socket example with custom context and IPv4:</p>
<pre class="literal-block">
hostname = 'www.python.org'
# PROTOCOL_TLS_CLIENT requires valid cert chain and hostname
context = ssl.SSLContext(ssl.PROTOCOL_TLS_CLIENT)
context.load_verify_locations('path/to/cabundle.pem')

with socket.socket(socket.AF_INET, socket.SOCK_STREAM, 0) as sock:
    with context.wrap_socket(sock, server_hostname=hostname) as ssock:
        print(ssock.version())
</pre>
<p>Server socket example listening on localhost IPv4:</p>
<pre class="literal-block">
context = ssl.SSLContext(ssl.PROTOCOL_TLS_SERVER)
context.load_cert_chain('/path/to/certchain.pem', '/path/to/private.key')

with socket.socket(socket.AF_INET, socket.SOCK_STREAM, 0) as sock:
    sock.bind(('127.0.0.1', 8443))
    sock.listen(5)
    with context.wrap_socket(sock, server_side=True) as ssock:
        conn, addr = ssock.accept()
        ...
</pre>
</div>
<div class="section" id="context-creation">
<h2>Context creation</h2>
<p>A convenience function helps create <a href="#id29"><span class="problematic" id="id30">:class:`SSLContext`</span></a> objects for common
purposes.</p>
<div class="system-message" id="id29">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 118); <em><a href="#id30">backlink</a></em></p>
Unknown interpreted text role &quot;class&quot;.</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 121)</p>
<p>Unknown directive type &quot;function&quot;.</p>
<pre class="literal-block">
.. function:: create_default_context(purpose=Purpose.SERVER_AUTH, cafile=None, capath=None, cadata=None)

   Return a new :class:`SSLContext` object with default settings for
   the given *purpose*.  The settings are chosen by the :mod:`ssl` module,
   and usually represent a higher security level than when calling the
   :class:`SSLContext` constructor directly.

   *cafile*, *capath*, *cadata* represent optional CA certificates to
   trust for certificate verification, as in
   :meth:`SSLContext.load_verify_locations`.  If all three are
   :const:`None`, this function can choose to trust the system's default
   CA certificates instead.

   The settings are: :data:`PROTOCOL_TLS`, :data:`OP_NO_SSLv2`, and
   :data:`OP_NO_SSLv3` with high encryption cipher suites without RC4 and
   without unauthenticated cipher suites. Passing :data:`~Purpose.SERVER_AUTH`
   as *purpose* sets :data:`~SSLContext.verify_mode` to :data:`CERT_REQUIRED`
   and either loads CA certificates (when at least one of *cafile*, *capath* or
   *cadata* is given) or uses :meth:`SSLContext.load_default_certs` to load
   default CA certificates.

   When :attr:`~SSLContext.keylog_filename` is supported and the environment
   variable :envvar:`SSLKEYLOGFILE` is set, :func:`create_default_context`
   enables key logging.

   .. note::
      The protocol, options, cipher and other settings may change to more
      restrictive values anytime without prior deprecation.  The values
      represent a fair balance between compatibility and security.

      If your application needs specific settings, you should create a
      :class:`SSLContext` and apply the settings yourself.

   .. note::
      If you find that when certain older clients or servers attempt to connect
      with a :class:`SSLContext` created by this function that they get an error
      stating &quot;Protocol or cipher suite mismatch&quot;, it may be that they only
      support SSL3.0 which this function excludes using the
      :data:`OP_NO_SSLv3`. SSL3.0 is widely considered to be `completely broken
      &lt;https://en.wikipedia.org/wiki/POODLE&gt;`_. If you still wish to continue to
      use this function but still allow SSL 3.0 connections you can re-enable
      them using::

         ctx = ssl.create_default_context(Purpose.CLIENT_AUTH)
         ctx.options &amp;= ~ssl.OP_NO_SSLv3

   .. versionadded:: 3.4

   .. versionchanged:: 3.4.4

     RC4 was dropped from the default cipher string.

   .. versionchanged:: 3.6

     ChaCha20/Poly1305 was added to the default cipher string.

     3DES was dropped from the default cipher string.

   .. versionchanged:: 3.8

      Support for key logging to :envvar:`SSLKEYLOGFILE` was added.


</pre>
</div>
</div>
<div class="section" id="exceptions">
<h2>Exceptions</h2>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 187)</p>
<p>Unknown directive type &quot;exception&quot;.</p>
<pre class="literal-block">
.. exception:: SSLError

   Raised to signal an error from the underlying SSL implementation
   (currently provided by the OpenSSL library).  This signifies some
   problem in the higher-level encryption and authentication layer that's
   superimposed on the underlying network connection.  This error
   is a subtype of :exc:`OSError`.  The error code and message of
   :exc:`SSLError` instances are provided by the OpenSSL library.

   .. versionchanged:: 3.3
      :exc:`SSLError` used to be a subtype of :exc:`socket.error`.

   .. attribute:: library

      A string mnemonic designating the OpenSSL submodule in which the error
      occurred, such as ``SSL``, ``PEM`` or ``X509``.  The range of possible
      values depends on the OpenSSL version.

      .. versionadded:: 3.3

   .. attribute:: reason

      A string mnemonic designating the reason this error occurred, for
      example ``CERTIFICATE_VERIFY_FAILED``.  The range of possible
      values depends on the OpenSSL version.

      .. versionadded:: 3.3

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 215)</p>
<p>Unknown directive type &quot;exception&quot;.</p>
<pre class="literal-block">
.. exception:: SSLZeroReturnError

   A subclass of :exc:`SSLError` raised when trying to read or write and
   the SSL connection has been closed cleanly.  Note that this doesn't
   mean that the underlying transport (read TCP) has been closed.

   .. versionadded:: 3.3

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 223)</p>
<p>Unknown directive type &quot;exception&quot;.</p>
<pre class="literal-block">
.. exception:: SSLWantReadError

   A subclass of :exc:`SSLError` raised by a :ref:`non-blocking SSL socket
   &lt;ssl-nonblocking&gt;` when trying to read or write data, but more data needs
   to be received on the underlying TCP transport before the request can be
   fulfilled.

   .. versionadded:: 3.3

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 232)</p>
<p>Unknown directive type &quot;exception&quot;.</p>
<pre class="literal-block">
.. exception:: SSLWantWriteError

   A subclass of :exc:`SSLError` raised by a :ref:`non-blocking SSL socket
   &lt;ssl-nonblocking&gt;` when trying to read or write data, but more data needs
   to be sent on the underlying TCP transport before the request can be
   fulfilled.

   .. versionadded:: 3.3

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 241)</p>
<p>Unknown directive type &quot;exception&quot;.</p>
<pre class="literal-block">
.. exception:: SSLSyscallError

   A subclass of :exc:`SSLError` raised when a system error was encountered
   while trying to fulfill an operation on a SSL socket.  Unfortunately,
   there is no easy way to inspect the original errno number.

   .. versionadded:: 3.3

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 249)</p>
<p>Unknown directive type &quot;exception&quot;.</p>
<pre class="literal-block">
.. exception:: SSLEOFError

   A subclass of :exc:`SSLError` raised when the SSL connection has been
   terminated abruptly.  Generally, you shouldn't try to reuse the underlying
   transport when this error is encountered.

   .. versionadded:: 3.3

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 257)</p>
<p>Unknown directive type &quot;exception&quot;.</p>
<pre class="literal-block">
.. exception:: SSLCertVerificationError

   A subclass of :exc:`SSLError` raised when certificate validation has
   failed.

   .. versionadded:: 3.7

   .. attribute:: verify_code

      A numeric error number that denotes the verification error.

   .. attribute:: verify_message

      A human readable string of the verification error.

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 272)</p>
<p>Unknown directive type &quot;exception&quot;.</p>
<pre class="literal-block">
.. exception:: CertificateError

   An alias for :exc:`SSLCertVerificationError`.

   .. versionchanged:: 3.7
      The exception is now an alias for :exc:`SSLCertVerificationError`.


</pre>
</div>
</div>
<div class="section" id="random-generation">
<h2>Random generation</h2>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 283)</p>
<p>Unknown directive type &quot;function&quot;.</p>
<pre class="literal-block">
.. function:: RAND_bytes(num)

   Return *num* cryptographically strong pseudo-random bytes. Raises an
   :class:`SSLError` if the PRNG has not been seeded with enough data or if the
   operation is not supported by the current RAND method. :func:`RAND_status`
   can be used to check the status of the PRNG and :func:`RAND_add` can be used
   to seed the PRNG.

   For almost all applications :func:`os.urandom` is preferable.

   Read the Wikipedia article, `Cryptographically secure pseudorandom number
   generator (CSPRNG)
   &lt;https://en.wikipedia.org/wiki/Cryptographically_secure_pseudorandom_number_generator&gt;`_,
   to get the requirements of a cryptographically strong generator.

   .. versionadded:: 3.3

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 300)</p>
<p>Unknown directive type &quot;function&quot;.</p>
<pre class="literal-block">
.. function:: RAND_pseudo_bytes(num)

   Return (bytes, is_cryptographic): bytes are *num* pseudo-random bytes,
   is_cryptographic is ``True`` if the bytes generated are cryptographically
   strong. Raises an :class:`SSLError` if the operation is not supported by the
   current RAND method.

   Generated pseudo-random byte sequences will be unique if they are of
   sufficient length, but are not necessarily unpredictable. They can be used
   for non-cryptographic purposes and for certain purposes in cryptographic
   protocols, but usually not for key generation etc.

   For almost all applications :func:`os.urandom` is preferable.

   .. versionadded:: 3.3

   .. deprecated:: 3.6

      OpenSSL has deprecated :func:`ssl.RAND_pseudo_bytes`, use
      :func:`ssl.RAND_bytes` instead.

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 321)</p>
<p>Unknown directive type &quot;function&quot;.</p>
<pre class="literal-block">
.. function:: RAND_status()

   Return ``True`` if the SSL pseudo-random number generator has been seeded
   with 'enough' randomness, and ``False`` otherwise.  You can use
   :func:`ssl.RAND_egd` and :func:`ssl.RAND_add` to increase the randomness of
   the pseudo-random number generator.

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 328)</p>
<p>Unknown directive type &quot;function&quot;.</p>
<pre class="literal-block">
.. function:: RAND_egd(path)

   If you are running an entropy-gathering daemon (EGD) somewhere, and *path*
   is the pathname of a socket connection open to it, this will read 256 bytes
   of randomness from the socket, and add it to the SSL pseudo-random number
   generator to increase the security of generated secret keys.  This is
   typically only necessary on systems without better sources of randomness.

   See http://egd.sourceforge.net/ or http://prngd.sourceforge.net/ for sources
   of entropy-gathering daemons.

   .. availability:: not available with LibreSSL and OpenSSL &gt; 1.1.0.

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 341)</p>
<p>Unknown directive type &quot;function&quot;.</p>
<pre class="literal-block">
.. function:: RAND_add(bytes, entropy)

   Mix the given *bytes* into the SSL pseudo-random number generator.  The
   parameter *entropy* (a float) is a lower bound on the entropy contained in
   string (so you can always use :const:`0.0`).  See :rfc:`1750` for more
   information on sources of entropy.

   .. versionchanged:: 3.5
      Writable :term:`bytes-like object` is now accepted.

</pre>
</div>
</div>
<div class="section" id="certificate-handling">
<h2>Certificate handling</h2>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 354)</p>
<p>Unknown directive type &quot;testsetup&quot;.</p>
<pre class="literal-block">
.. testsetup::

   import ssl

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 358)</p>
<p>Unknown directive type &quot;function&quot;.</p>
<pre class="literal-block">
.. function:: match_hostname(cert, hostname)

   Verify that *cert* (in decoded format as returned by
   :meth:`SSLSocket.getpeercert`) matches the given *hostname*.  The rules
   applied are those for checking the identity of HTTPS servers as outlined
   in :rfc:`2818`, :rfc:`5280` and :rfc:`6125`.  In addition to HTTPS, this
   function should be suitable for checking the identity of servers in
   various SSL-based protocols such as FTPS, IMAPS, POPS and others.

   :exc:`CertificateError` is raised on failure. On success, the function
   returns nothing::

      &gt;&gt;&gt; cert = {'subject': ((('commonName', 'example.com'),),)}
      &gt;&gt;&gt; ssl.match_hostname(cert, &quot;example.com&quot;)
      &gt;&gt;&gt; ssl.match_hostname(cert, &quot;example.org&quot;)
      Traceback (most recent call last):
        File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;
        File &quot;/home/py3k/Lib/ssl.py&quot;, line 130, in match_hostname
      ssl.CertificateError: hostname 'example.org' doesn't match 'example.com'

   .. versionadded:: 3.2

   .. versionchanged:: 3.3.3
      The function now follows :rfc:`6125`, section 6.4.3 and does neither
      match multiple wildcards (e.g. ``*.*.com`` or ``*a*.example.org``) nor
      a wildcard inside an internationalized domain names (IDN) fragment.
      IDN A-labels such as ``www*.xn--pthon-kva.org`` are still supported,
      but ``x*.python.org`` no longer matches ``xn--tda.python.org``.

   .. versionchanged:: 3.5
      Matching of IP addresses, when present in the subjectAltName field
      of the certificate, is now supported.

   .. versionchanged:: 3.7
      The function is no longer used to TLS connections. Hostname matching
      is now performed by OpenSSL.

      Allow wildcard when it is the leftmost and the only character
      in that segment. Partial wildcards like ``www*.example.com`` are no
      longer supported.

   .. deprecated:: 3.7

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 401)</p>
<p>Unknown directive type &quot;function&quot;.</p>
<pre class="literal-block">
.. function:: cert_time_to_seconds(cert_time)

   Return the time in seconds since the Epoch, given the ``cert_time``
   string representing the &quot;notBefore&quot; or &quot;notAfter&quot; date from a
   certificate in ``&quot;%b %d %H:%M:%S %Y %Z&quot;`` strptime format (C
   locale).

   Here's an example:

   .. doctest:: newcontext

      &gt;&gt;&gt; import ssl
      &gt;&gt;&gt; timestamp = ssl.cert_time_to_seconds(&quot;Jan  5 09:34:43 2018 GMT&quot;)
      &gt;&gt;&gt; timestamp  # doctest: +SKIP
      1515144883
      &gt;&gt;&gt; from datetime import datetime
      &gt;&gt;&gt; print(datetime.utcfromtimestamp(timestamp))  # doctest: +SKIP
      2018-01-05 09:34:43

   &quot;notBefore&quot; or &quot;notAfter&quot; dates must use GMT (:rfc:`5280`).

   .. versionchanged:: 3.5
      Interpret the input time as a time in UTC as specified by 'GMT'
      timezone in the input string. Local timezone was used
      previously. Return an integer (no fractions of a second in the
      input format)

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 428)</p>
<p>Unknown directive type &quot;function&quot;.</p>
<pre class="literal-block">
.. function:: get_server_certificate(addr, ssl_version=PROTOCOL_TLS, ca_certs=None)

   Given the address ``addr`` of an SSL-protected server, as a (*hostname*,
   *port-number*) pair, fetches the server's certificate, and returns it as a
   PEM-encoded string.  If ``ssl_version`` is specified, uses that version of
   the SSL protocol to attempt to connect to the server.  If ``ca_certs`` is
   specified, it should be a file containing a list of root certificates, the
   same format as used for the same parameter in
   :meth:`SSLContext.wrap_socket`.  The call will attempt to validate the
   server certificate against that set of root certificates, and will fail
   if the validation attempt fails.

   .. versionchanged:: 3.3
      This function is now IPv6-compatible.

   .. versionchanged:: 3.5
      The default *ssl_version* is changed from :data:`PROTOCOL_SSLv3` to
      :data:`PROTOCOL_TLS` for maximum compatibility with modern servers.

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 447)</p>
<p>Unknown directive type &quot;function&quot;.</p>
<pre class="literal-block">
.. function:: DER_cert_to_PEM_cert(DER_cert_bytes)

   Given a certificate as a DER-encoded blob of bytes, returns a PEM-encoded
   string version of the same certificate.

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 452)</p>
<p>Unknown directive type &quot;function&quot;.</p>
<pre class="literal-block">
.. function:: PEM_cert_to_DER_cert(PEM_cert_string)

   Given a certificate as an ASCII PEM string, returns a DER-encoded sequence of
   bytes for that same certificate.

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 457)</p>
<p>Unknown directive type &quot;function&quot;.</p>
<pre class="literal-block">
.. function:: get_default_verify_paths()

   Returns a named tuple with paths to OpenSSL's default cafile and capath.
   The paths are the same as used by
   :meth:`SSLContext.set_default_verify_paths`. The return value is a
   :term:`named tuple` ``DefaultVerifyPaths``:

   * :attr:`cafile` - resolved path to cafile or ``None`` if the file doesn't exist,
   * :attr:`capath` - resolved path to capath or ``None`` if the directory doesn't exist,
   * :attr:`openssl_cafile_env` - OpenSSL's environment key that points to a cafile,
   * :attr:`openssl_cafile` - hard coded path to a cafile,
   * :attr:`openssl_capath_env` - OpenSSL's environment key that points to a capath,
   * :attr:`openssl_capath` - hard coded path to a capath directory

   .. availability:: LibreSSL ignores the environment vars
     :attr:`openssl_cafile_env` and :attr:`openssl_capath_env`.

   .. versionadded:: 3.4

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 476)</p>
<p>Unknown directive type &quot;function&quot;.</p>
<pre class="literal-block">
.. function:: enum_certificates(store_name)

   Retrieve certificates from Windows' system cert store. *store_name* may be
   one of ``CA``, ``ROOT`` or ``MY``. Windows may provide additional cert
   stores, too.

   The function returns a list of (cert_bytes, encoding_type, trust) tuples.
   The encoding_type specifies the encoding of cert_bytes. It is either
   :const:`x509_asn` for X.509 ASN.1 data or :const:`pkcs_7_asn` for
   PKCS#7 ASN.1 data. Trust specifies the purpose of the certificate as a set
   of OIDS or exactly ``True`` if the certificate is trustworthy for all
   purposes.

   Example::

      &gt;&gt;&gt; ssl.enum_certificates(&quot;CA&quot;)
      [(b'data...', 'x509_asn', {'1.3.6.1.5.5.7.3.1', '1.3.6.1.5.5.7.3.2'}),
       (b'data...', 'x509_asn', True)]

   .. availability:: Windows.

   .. versionadded:: 3.4

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 499)</p>
<p>Unknown directive type &quot;function&quot;.</p>
<pre class="literal-block">
.. function:: enum_crls(store_name)

   Retrieve CRLs from Windows' system cert store. *store_name* may be
   one of ``CA``, ``ROOT`` or ``MY``. Windows may provide additional cert
   stores, too.

   The function returns a list of (cert_bytes, encoding_type, trust) tuples.
   The encoding_type specifies the encoding of cert_bytes. It is either
   :const:`x509_asn` for X.509 ASN.1 data or :const:`pkcs_7_asn` for
   PKCS#7 ASN.1 data.

   .. availability:: Windows.

   .. versionadded:: 3.4

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 514)</p>
<p>Unknown directive type &quot;function&quot;.</p>
<pre class="literal-block">
.. function:: wrap_socket(sock, keyfile=None, certfile=None, \
       server_side=False, cert_reqs=CERT_NONE, ssl_version=PROTOCOL_TLS, \
       ca_certs=None, do_handshake_on_connect=True, \
       suppress_ragged_eofs=True, ciphers=None)

   Takes an instance ``sock`` of :class:`socket.socket`, and returns an instance
   of :class:`ssl.SSLSocket`, a subtype of :class:`socket.socket`, which wraps
   the underlying socket in an SSL context.  ``sock`` must be a
   :data:`~socket.SOCK_STREAM` socket; other socket types are unsupported.

   Internally, function creates a :class:`SSLContext` with protocol
   *ssl_version* and :attr:`SSLContext.options` set to *cert_reqs*. If
   parameters *keyfile*, *certfile*, *ca_certs* or *ciphers* are set, then
   the values are passed to :meth:`SSLContext.load_cert_chain`,
   :meth:`SSLContext.load_verify_locations`, and
   :meth:`SSLContext.set_ciphers`.

   The arguments *server_side*, *do_handshake_on_connect*, and
   *suppress_ragged_eofs* have the same meaning as
   :meth:`SSLContext.wrap_socket`.

   .. deprecated:: 3.7

      Since Python 3.2 and 2.7.9, it is recommended to use the
      :meth:`SSLContext.wrap_socket` instead of :func:`wrap_socket`. The
      top-level function is limited and creates an insecure client socket
      without server name indication or hostname matching.

</pre>
</div>
</div>
<div class="section" id="constants">
<h2>Constants</h2>
<blockquote>
<p>All constants are now <a href="#id31"><span class="problematic" id="id32">:class:`enum.IntEnum`</span></a> or <a href="#id33"><span class="problematic" id="id34">:class:`enum.IntFlag`</span></a> collections.</p>
<div class="system-message" id="id31">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 545); <em><a href="#id32">backlink</a></em></p>
Unknown interpreted text role &quot;class&quot;.</div>
<div class="system-message" id="id33">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 545); <em><a href="#id34">backlink</a></em></p>
Unknown interpreted text role &quot;class&quot;.</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 547)</p>
<p>Unknown directive type &quot;versionadded&quot;.</p>
<pre class="literal-block">
.. versionadded:: 3.6

</pre>
</div>
</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 549)</p>
<p>Unknown directive type &quot;data&quot;.</p>
<pre class="literal-block">
.. data:: CERT_NONE

   Possible value for :attr:`SSLContext.verify_mode`, or the ``cert_reqs``
   parameter to :func:`wrap_socket`.  Except for :const:`PROTOCOL_TLS_CLIENT`,
   it is the default mode.  With client-side sockets, just about any
   cert is accepted.  Validation errors, such as untrusted or expired cert,
   are ignored and do not abort the TLS/SSL handshake.

   In server mode, no certificate is requested from the client, so the client
   does not send any for client cert authentication.

   See the discussion of :ref:`ssl-security` below.

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 562)</p>
<p>Unknown directive type &quot;data&quot;.</p>
<pre class="literal-block">
.. data:: CERT_OPTIONAL

   Possible value for :attr:`SSLContext.verify_mode`, or the ``cert_reqs``
   parameter to :func:`wrap_socket`.  In client mode, :const:`CERT_OPTIONAL`
   has the same meaning as :const:`CERT_REQUIRED`. It is recommended to
   use :const:`CERT_REQUIRED` for client-side sockets instead.

   In server mode, a client certificate request is sent to the client.  The
   client may either ignore the request or send a certificate in order
   perform TLS client cert authentication.  If the client chooses to send
   a certificate, it is verified.  Any verification error immediately aborts
   the TLS handshake.

   Use of this setting requires a valid set of CA certificates to
   be passed, either to :meth:`SSLContext.load_verify_locations` or as a
   value of the ``ca_certs`` parameter to :func:`wrap_socket`.

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 579)</p>
<p>Unknown directive type &quot;data&quot;.</p>
<pre class="literal-block">
.. data:: CERT_REQUIRED

   Possible value for :attr:`SSLContext.verify_mode`, or the ``cert_reqs``
   parameter to :func:`wrap_socket`.  In this mode, certificates are
   required from the other side of the socket connection; an :class:`SSLError`
   will be raised if no certificate is provided, or if its validation fails.
   This mode is **not** sufficient to verify a certificate in client mode as
   it does not match hostnames.  :attr:`~SSLContext.check_hostname` must be
   enabled as well to verify the authenticity of a cert.
   :const:`PROTOCOL_TLS_CLIENT` uses :const:`CERT_REQUIRED` and
   enables :attr:`~SSLContext.check_hostname` by default.

   With server socket, this mode provides mandatory TLS client cert
   authentication.  A client certificate request is sent to the client and
   the client must provide a valid and trusted certificate.

   Use of this setting requires a valid set of CA certificates to
   be passed, either to :meth:`SSLContext.load_verify_locations` or as a
   value of the ``ca_certs`` parameter to :func:`wrap_socket`.

</pre>
</div>
<p class="verifymode"><a href="#id35"><span class="problematic" id="id36">:class:`enum.IntEnum`</span></a> collection of CERT_* constants.</p>
<div class="verifymode system-message" id="id35">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 601); <em><a href="#id36">backlink</a></em></p>
Unknown interpreted text role &quot;class&quot;.</div>
<div class="verifymode system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 603)</p>
<p>Unknown directive type &quot;versionadded&quot;.</p>
<pre class="literal-block">
.. versionadded:: 3.6
</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 605)</p>
<p>Unknown directive type &quot;data&quot;.</p>
<pre class="literal-block">
.. data:: VERIFY_DEFAULT

   Possible value for :attr:`SSLContext.verify_flags`. In this mode, certificate
   revocation lists (CRLs) are not checked. By default OpenSSL does neither
   require nor verify CRLs.

   .. versionadded:: 3.4

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 613)</p>
<p>Unknown directive type &quot;data&quot;.</p>
<pre class="literal-block">
.. data:: VERIFY_CRL_CHECK_LEAF

   Possible value for :attr:`SSLContext.verify_flags`. In this mode, only the
   peer cert is checked but none of the intermediate CA certificates. The mode
   requires a valid CRL that is signed by the peer cert's issuer (its direct
   ancestor CA). If no proper CRL has been loaded with
   :attr:`SSLContext.load_verify_locations`, validation will fail.

   .. versionadded:: 3.4

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 623)</p>
<p>Unknown directive type &quot;data&quot;.</p>
<pre class="literal-block">
.. data:: VERIFY_CRL_CHECK_CHAIN

   Possible value for :attr:`SSLContext.verify_flags`. In this mode, CRLs of
   all certificates in the peer cert chain are checked.

   .. versionadded:: 3.4

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 630)</p>
<p>Unknown directive type &quot;data&quot;.</p>
<pre class="literal-block">
.. data:: VERIFY_X509_STRICT

   Possible value for :attr:`SSLContext.verify_flags` to disable workarounds
   for broken X.509 certificates.

   .. versionadded:: 3.4

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 637)</p>
<p>Unknown directive type &quot;data&quot;.</p>
<pre class="literal-block">
.. data:: VERIFY_X509_TRUSTED_FIRST

   Possible value for :attr:`SSLContext.verify_flags`. It instructs OpenSSL to
   prefer trusted certificates when building the trust chain to validate a
   certificate. This flag is enabled by default.

   .. versionadded:: 3.4.4

</pre>
</div>
<p class="verifyflags"><a href="#id37"><span class="problematic" id="id38">:class:`enum.IntFlag`</span></a> collection of VERIFY_* constants.</p>
<div class="verifyflags system-message" id="id37">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 647); <em><a href="#id38">backlink</a></em></p>
Unknown interpreted text role &quot;class&quot;.</div>
<div class="verifyflags system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 649)</p>
<p>Unknown directive type &quot;versionadded&quot;.</p>
<pre class="literal-block">
.. versionadded:: 3.6
</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 651)</p>
<p>Unknown directive type &quot;data&quot;.</p>
<pre class="literal-block">
.. data:: PROTOCOL_TLS

   Selects the highest protocol version that both the client and server support.
   Despite the name, this option can select both &quot;SSL&quot; and &quot;TLS&quot; protocols.

   .. versionadded:: 3.6

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 658)</p>
<p>Unknown directive type &quot;data&quot;.</p>
<pre class="literal-block">
.. data:: PROTOCOL_TLS_CLIENT

   Auto-negotiate the highest protocol version like :data:`PROTOCOL_TLS`,
   but only support client-side :class:`SSLSocket` connections. The protocol
   enables :data:`CERT_REQUIRED` and :attr:`~SSLContext.check_hostname` by
   default.

   .. versionadded:: 3.6

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 667)</p>
<p>Unknown directive type &quot;data&quot;.</p>
<pre class="literal-block">
.. data:: PROTOCOL_TLS_SERVER

   Auto-negotiate the highest protocol version like :data:`PROTOCOL_TLS`,
   but only support server-side :class:`SSLSocket` connections.

   .. versionadded:: 3.6

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 674)</p>
<p>Unknown directive type &quot;data&quot;.</p>
<pre class="literal-block">
.. data:: PROTOCOL_SSLv23

   Alias for :data:`PROTOCOL_TLS`.

   .. deprecated:: 3.6

      Use :data:`PROTOCOL_TLS` instead.

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 682)</p>
<p>Unknown directive type &quot;data&quot;.</p>
<pre class="literal-block">
.. data:: PROTOCOL_SSLv2

   Selects SSL version 2 as the channel encryption protocol.

   This protocol is not available if OpenSSL is compiled with the
   ``OPENSSL_NO_SSL2`` flag.

   .. warning::

      SSL version 2 is insecure.  Its use is highly discouraged.

   .. deprecated:: 3.6

      OpenSSL has removed support for SSLv2.

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 697)</p>
<p>Unknown directive type &quot;data&quot;.</p>
<pre class="literal-block">
.. data:: PROTOCOL_SSLv3

   Selects SSL version 3 as the channel encryption protocol.

   This protocol is not be available if OpenSSL is compiled with the
   ``OPENSSL_NO_SSLv3`` flag.

   .. warning::

      SSL version 3 is insecure.  Its use is highly discouraged.

   .. deprecated:: 3.6

      OpenSSL has deprecated all version specific protocols. Use the default
      protocol :data:`PROTOCOL_TLS` with flags like :data:`OP_NO_SSLv3` instead.

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 713)</p>
<p>Unknown directive type &quot;data&quot;.</p>
<pre class="literal-block">
.. data:: PROTOCOL_TLSv1

   Selects TLS version 1.0 as the channel encryption protocol.

   .. deprecated:: 3.6

      OpenSSL has deprecated all version specific protocols. Use the default
      protocol :data:`PROTOCOL_TLS` with flags like :data:`OP_NO_SSLv3` instead.

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 722)</p>
<p>Unknown directive type &quot;data&quot;.</p>
<pre class="literal-block">
.. data:: PROTOCOL_TLSv1_1

   Selects TLS version 1.1 as the channel encryption protocol.
   Available only with openssl version 1.0.1+.

   .. versionadded:: 3.4

   .. deprecated:: 3.6

      OpenSSL has deprecated all version specific protocols. Use the default
      protocol :data:`PROTOCOL_TLS` with flags like :data:`OP_NO_SSLv3` instead.

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 734)</p>
<p>Unknown directive type &quot;data&quot;.</p>
<pre class="literal-block">
.. data:: PROTOCOL_TLSv1_2

   Selects TLS version 1.2 as the channel encryption protocol. This is the
   most modern version, and probably the best choice for maximum protection,
   if both sides can speak it.  Available only with openssl version 1.0.1+.

   .. versionadded:: 3.4

   .. deprecated:: 3.6

      OpenSSL has deprecated all version specific protocols. Use the default
      protocol :data:`PROTOCOL_TLS` with flags like :data:`OP_NO_SSLv3` instead.

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 747)</p>
<p>Unknown directive type &quot;data&quot;.</p>
<pre class="literal-block">
.. data:: OP_ALL

   Enables workarounds for various bugs present in other SSL implementations.
   This option is set by default.  It does not necessarily set the same
   flags as OpenSSL's ``SSL_OP_ALL`` constant.

   .. versionadded:: 3.2

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 755)</p>
<p>Unknown directive type &quot;data&quot;.</p>
<pre class="literal-block">
.. data:: OP_NO_SSLv2

   Prevents an SSLv2 connection.  This option is only applicable in
   conjunction with :const:`PROTOCOL_TLS`.  It prevents the peers from
   choosing SSLv2 as the protocol version.

   .. versionadded:: 3.2

   .. deprecated:: 3.6

      SSLv2 is deprecated


</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 768)</p>
<p>Unknown directive type &quot;data&quot;.</p>
<pre class="literal-block">
.. data:: OP_NO_SSLv3

   Prevents an SSLv3 connection.  This option is only applicable in
   conjunction with :const:`PROTOCOL_TLS`.  It prevents the peers from
   choosing SSLv3 as the protocol version.

   .. versionadded:: 3.2

   .. deprecated:: 3.6

      SSLv3 is deprecated

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 780)</p>
<p>Unknown directive type &quot;data&quot;.</p>
<pre class="literal-block">
.. data:: OP_NO_TLSv1

   Prevents a TLSv1 connection.  This option is only applicable in
   conjunction with :const:`PROTOCOL_TLS`.  It prevents the peers from
   choosing TLSv1 as the protocol version.

   .. versionadded:: 3.2

   .. deprecated:: 3.7
      The option is deprecated since OpenSSL 1.1.0, use the new
      :attr:`SSLContext.minimum_version` and
      :attr:`SSLContext.maximum_version` instead.

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 793)</p>
<p>Unknown directive type &quot;data&quot;.</p>
<pre class="literal-block">
.. data:: OP_NO_TLSv1_1

   Prevents a TLSv1.1 connection. This option is only applicable in conjunction
   with :const:`PROTOCOL_TLS`. It prevents the peers from choosing TLSv1.1 as
   the protocol version. Available only with openssl version 1.0.1+.

   .. versionadded:: 3.4

   .. deprecated:: 3.7
      The option is deprecated since OpenSSL 1.1.0.

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 804)</p>
<p>Unknown directive type &quot;data&quot;.</p>
<pre class="literal-block">
.. data:: OP_NO_TLSv1_2

   Prevents a TLSv1.2 connection. This option is only applicable in conjunction
   with :const:`PROTOCOL_TLS`. It prevents the peers from choosing TLSv1.2 as
   the protocol version. Available only with openssl version 1.0.1+.

   .. versionadded:: 3.4

   .. deprecated:: 3.7
      The option is deprecated since OpenSSL 1.1.0.

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 815)</p>
<p>Unknown directive type &quot;data&quot;.</p>
<pre class="literal-block">
.. data:: OP_NO_TLSv1_3

   Prevents a TLSv1.3 connection. This option is only applicable in conjunction
   with :const:`PROTOCOL_TLS`. It prevents the peers from choosing TLSv1.3 as
   the protocol version. TLS 1.3 is available with OpenSSL 1.1.1 or later.
   When Python has been compiled against an older version of OpenSSL, the
   flag defaults to *0*.

   .. versionadded:: 3.7

   .. deprecated:: 3.7
      The option is deprecated since OpenSSL 1.1.0. It was added to 2.7.15,
      3.6.3 and 3.7.0 for backwards compatibility with OpenSSL 1.0.2.

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 829)</p>
<p>Unknown directive type &quot;data&quot;.</p>
<pre class="literal-block">
.. data:: OP_NO_RENEGOTIATION

   Disable all renegotiation in TLSv1.2 and earlier. Do not send
   HelloRequest messages, and ignore renegotiation requests via ClientHello.

   This option is only available with OpenSSL 1.1.0h and later.

   .. versionadded:: 3.7

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 838)</p>
<p>Unknown directive type &quot;data&quot;.</p>
<pre class="literal-block">
.. data:: OP_CIPHER_SERVER_PREFERENCE

   Use the server's cipher ordering preference, rather than the client's.
   This option has no effect on client sockets and SSLv2 server sockets.

   .. versionadded:: 3.3

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 845)</p>
<p>Unknown directive type &quot;data&quot;.</p>
<pre class="literal-block">
.. data:: OP_SINGLE_DH_USE

   Prevents re-use of the same DH key for distinct SSL sessions.  This
   improves forward secrecy but requires more computational resources.
   This option only applies to server sockets.

   .. versionadded:: 3.3

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 853)</p>
<p>Unknown directive type &quot;data&quot;.</p>
<pre class="literal-block">
.. data:: OP_SINGLE_ECDH_USE

   Prevents re-use of the same ECDH key for distinct SSL sessions.  This
   improves forward secrecy but requires more computational resources.
   This option only applies to server sockets.

   .. versionadded:: 3.3

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 861)</p>
<p>Unknown directive type &quot;data&quot;.</p>
<pre class="literal-block">
.. data:: OP_ENABLE_MIDDLEBOX_COMPAT

   Send dummy Change Cipher Spec (CCS) messages in TLS 1.3 handshake to make
   a TLS 1.3 connection look more like a TLS 1.2 connection.

   This option is only available with OpenSSL 1.1.1 and later.

   .. versionadded:: 3.8

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 870)</p>
<p>Unknown directive type &quot;data&quot;.</p>
<pre class="literal-block">
.. data:: OP_NO_COMPRESSION

   Disable compression on the SSL channel.  This is useful if the application
   protocol supports its own compression scheme.

   This option is only available with OpenSSL 1.0.0 and later.

   .. versionadded:: 3.3

</pre>
</div>
<p class="options"><a href="#id39"><span class="problematic" id="id40">:class:`enum.IntFlag`</span></a> collection of OP_* constants.</p>
<div class="options system-message" id="id39">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 881); <em><a href="#id40">backlink</a></em></p>
Unknown interpreted text role &quot;class&quot;.</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 883)</p>
<p>Unknown directive type &quot;data&quot;.</p>
<pre class="literal-block">
.. data:: OP_NO_TICKET

   Prevent client side from requesting a session ticket.

   .. versionadded:: 3.6

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 889)</p>
<p>Unknown directive type &quot;data&quot;.</p>
<pre class="literal-block">
.. data:: HAS_ALPN

   Whether the OpenSSL library has built-in support for the *Application-Layer
   Protocol Negotiation* TLS extension as described in :rfc:`7301`.

   .. versionadded:: 3.5

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 896)</p>
<p>Unknown directive type &quot;data&quot;.</p>
<pre class="literal-block">
.. data:: HAS_NEVER_CHECK_COMMON_NAME

   Whether the OpenSSL library has built-in support not checking subject
   common name and :attr:`SSLContext.hostname_checks_common_name` is
   writeable.

   .. versionadded:: 3.7

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 904)</p>
<p>Unknown directive type &quot;data&quot;.</p>
<pre class="literal-block">
.. data:: HAS_ECDH

   Whether the OpenSSL library has built-in support for the Elliptic Curve-based
   Diffie-Hellman key exchange.  This should be true unless the feature was
   explicitly disabled by the distributor.

   .. versionadded:: 3.3

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 912)</p>
<p>Unknown directive type &quot;data&quot;.</p>
<pre class="literal-block">
.. data:: HAS_SNI

   Whether the OpenSSL library has built-in support for the *Server Name
   Indication* extension (as defined in :rfc:`6066`).

   .. versionadded:: 3.2

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 919)</p>
<p>Unknown directive type &quot;data&quot;.</p>
<pre class="literal-block">
.. data:: HAS_NPN

   Whether the OpenSSL library has built-in support for the *Next Protocol
   Negotiation* as described in the `Application Layer Protocol
   Negotiation &lt;https://en.wikipedia.org/wiki/Application-Layer_Protocol_Negotiation&gt;`_.
   When true, you can use the :meth:`SSLContext.set_npn_protocols` method to advertise
   which protocols you want to support.

   .. versionadded:: 3.3

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 929)</p>
<p>Unknown directive type &quot;data&quot;.</p>
<pre class="literal-block">
.. data:: HAS_SSLv2

   Whether the OpenSSL library has built-in support for the SSL 2.0 protocol.

   .. versionadded:: 3.7

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 935)</p>
<p>Unknown directive type &quot;data&quot;.</p>
<pre class="literal-block">
.. data:: HAS_SSLv3

   Whether the OpenSSL library has built-in support for the SSL 3.0 protocol.

   .. versionadded:: 3.7

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 941)</p>
<p>Unknown directive type &quot;data&quot;.</p>
<pre class="literal-block">
.. data:: HAS_TLSv1

   Whether the OpenSSL library has built-in support for the TLS 1.0 protocol.

   .. versionadded:: 3.7

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 947)</p>
<p>Unknown directive type &quot;data&quot;.</p>
<pre class="literal-block">
.. data:: HAS_TLSv1_1

   Whether the OpenSSL library has built-in support for the TLS 1.1 protocol.

   .. versionadded:: 3.7

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 953)</p>
<p>Unknown directive type &quot;data&quot;.</p>
<pre class="literal-block">
.. data:: HAS_TLSv1_2

   Whether the OpenSSL library has built-in support for the TLS 1.2 protocol.

   .. versionadded:: 3.7

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 959)</p>
<p>Unknown directive type &quot;data&quot;.</p>
<pre class="literal-block">
.. data:: HAS_TLSv1_3

   Whether the OpenSSL library has built-in support for the TLS 1.3 protocol.

   .. versionadded:: 3.7

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 965)</p>
<p>Unknown directive type &quot;data&quot;.</p>
<pre class="literal-block">
.. data:: CHANNEL_BINDING_TYPES

   List of supported TLS channel binding types.  Strings in this list
   can be used as arguments to :meth:`SSLSocket.get_channel_binding`.

   .. versionadded:: 3.3

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 972)</p>
<p>Unknown directive type &quot;data&quot;.</p>
<pre class="literal-block">
.. data:: OPENSSL_VERSION

   The version string of the OpenSSL library loaded by the interpreter::

    &gt;&gt;&gt; ssl.OPENSSL_VERSION
    'OpenSSL 1.0.2k  26 Jan 2017'

   .. versionadded:: 3.2

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 981)</p>
<p>Unknown directive type &quot;data&quot;.</p>
<pre class="literal-block">
.. data:: OPENSSL_VERSION_INFO

   A tuple of five integers representing version information about the
   OpenSSL library::

    &gt;&gt;&gt; ssl.OPENSSL_VERSION_INFO
    (1, 0, 2, 11, 15)

   .. versionadded:: 3.2

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 991)</p>
<p>Unknown directive type &quot;data&quot;.</p>
<pre class="literal-block">
.. data:: OPENSSL_VERSION_NUMBER

   The raw version number of the OpenSSL library, as a single integer::

    &gt;&gt;&gt; ssl.OPENSSL_VERSION_NUMBER
    268443839
    &gt;&gt;&gt; hex(ssl.OPENSSL_VERSION_NUMBER)
    '0x100020bf'

   .. versionadded:: 3.2

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1002)</p>
<p>Unknown directive type &quot;data&quot;.</p>
<pre class="literal-block">
.. data:: ALERT_DESCRIPTION_HANDSHAKE_FAILURE
          ALERT_DESCRIPTION_INTERNAL_ERROR
          ALERT_DESCRIPTION_*

   Alert Descriptions from :rfc:`5246` and others. The `IANA TLS Alert Registry
   &lt;https://www.iana.org/assignments/tls-parameters/tls-parameters.xml#tls-parameters-6&gt;`_
   contains this list and references to the RFCs where their meaning is defined.

   Used as the return value of the callback function in
   :meth:`SSLContext.set_servername_callback`.

   .. versionadded:: 3.4

</pre>
</div>
<p class="alertdescription"><a href="#id41"><span class="problematic" id="id42">:class:`enum.IntEnum`</span></a> collection of ALERT_DESCRIPTION_* constants.</p>
<div class="alertdescription system-message" id="id41">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1017); <em><a href="#id42">backlink</a></em></p>
Unknown interpreted text role &quot;class&quot;.</div>
<div class="alertdescription system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1019)</p>
<p>Unknown directive type &quot;versionadded&quot;.</p>
<pre class="literal-block">
.. versionadded:: 3.6
</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1021)</p>
<p>Unknown directive type &quot;data&quot;.</p>
<pre class="literal-block">
.. data:: Purpose.SERVER_AUTH

   Option for :func:`create_default_context` and
   :meth:`SSLContext.load_default_certs`.  This value indicates that the
   context may be used to authenticate Web servers (therefore, it will
   be used to create client-side sockets).

   .. versionadded:: 3.4

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1030)</p>
<p>Unknown directive type &quot;data&quot;.</p>
<pre class="literal-block">
.. data:: Purpose.CLIENT_AUTH

   Option for :func:`create_default_context` and
   :meth:`SSLContext.load_default_certs`.  This value indicates that the
   context may be used to authenticate Web clients (therefore, it will
   be used to create server-side sockets).

   .. versionadded:: 3.4

</pre>
</div>
<p class="sslerrornumber"><a href="#id43"><span class="problematic" id="id44">:class:`enum.IntEnum`</span></a> collection of SSL_ERROR_* constants.</p>
<div class="sslerrornumber system-message" id="id43">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1041); <em><a href="#id44">backlink</a></em></p>
Unknown interpreted text role &quot;class&quot;.</div>
<div class="sslerrornumber system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1043)</p>
<p>Unknown directive type &quot;versionadded&quot;.</p>
<pre class="literal-block">
.. versionadded:: 3.6
</pre>
</div>
<p class="tlsversion"><a href="#id45"><span class="problematic" id="id46">:class:`enum.IntEnum`</span></a> collection of SSL and TLS versions for
<a href="#id47"><span class="problematic" id="id48">:attr:`SSLContext.maximum_version`</span></a> and <a href="#id49"><span class="problematic" id="id50">:attr:`SSLContext.minimum_version`</span></a>.</p>
<div class="tlsversion system-message" id="id45">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1047); <em><a href="#id46">backlink</a></em></p>
Unknown interpreted text role &quot;class&quot;.</div>
<div class="tlsversion system-message" id="id47">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1047); <em><a href="#id48">backlink</a></em></p>
Unknown interpreted text role &quot;attr&quot;.</div>
<div class="tlsversion system-message" id="id49">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1047); <em><a href="#id50">backlink</a></em></p>
Unknown interpreted text role &quot;attr&quot;.</div>
<div class="tlsversion system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1050)</p>
<p>Unknown directive type &quot;versionadded&quot;.</p>
<pre class="literal-block">
.. versionadded:: 3.7
</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1052)</p>
<p>Unknown directive type &quot;attribute&quot;.</p>
<pre class="literal-block">
.. attribute:: TLSVersion.MINIMUM_SUPPORTED
</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1053)</p>
<p>Unknown directive type &quot;attribute&quot;.</p>
<pre class="literal-block">
.. attribute:: TLSVersion.MAXIMUM_SUPPORTED

   The minimum or maximum supported SSL or TLS version. These are magic
   constants. Their values don't reflect the lowest and highest available
   TLS/SSL versions.

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1059)</p>
<p>Unknown directive type &quot;attribute&quot;.</p>
<pre class="literal-block">
.. attribute:: TLSVersion.SSLv3
</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1060)</p>
<p>Unknown directive type &quot;attribute&quot;.</p>
<pre class="literal-block">
.. attribute:: TLSVersion.TLSv1
</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1061)</p>
<p>Unknown directive type &quot;attribute&quot;.</p>
<pre class="literal-block">
.. attribute:: TLSVersion.TLSv1_1
</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1062)</p>
<p>Unknown directive type &quot;attribute&quot;.</p>
<pre class="literal-block">
.. attribute:: TLSVersion.TLSv1_2
</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1063)</p>
<p>Unknown directive type &quot;attribute&quot;.</p>
<pre class="literal-block">
.. attribute:: TLSVersion.TLSv1_3

   SSL 3.0 to TLS 1.3.


</pre>
</div>
</div>
</div>
<div class="section" id="ssl-sockets">
<h1>SSL Sockets</h1>
<p class="sslsocket-socket-socket">SSL sockets provide the following methods of <a href="#id51"><span class="problematic" id="id52">:ref:`socket-objects`</span></a>:</p>
<div class="sslsocket-socket-socket system-message" id="id51">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1073); <em><a href="#id52">backlink</a></em></p>
Unknown interpreted text role &quot;ref&quot;.</div>
<ul class="sslsocket-socket-socket">
<li><p class="first"><a href="#id53"><span class="problematic" id="id54">:meth:`~socket.socket.accept()`</span></a></p>
<div class="system-message" id="id53">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1075); <em><a href="#id54">backlink</a></em></p>
<p>Unknown interpreted text role &quot;meth&quot;.</p>
</div>
</li>
<li><p class="first"><a href="#id55"><span class="problematic" id="id56">:meth:`~socket.socket.bind()`</span></a></p>
<div class="system-message" id="id55">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1076); <em><a href="#id56">backlink</a></em></p>
<p>Unknown interpreted text role &quot;meth&quot;.</p>
</div>
</li>
<li><p class="first"><a href="#id57"><span class="problematic" id="id58">:meth:`~socket.socket.close()`</span></a></p>
<div class="system-message" id="id57">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1077); <em><a href="#id58">backlink</a></em></p>
<p>Unknown interpreted text role &quot;meth&quot;.</p>
</div>
</li>
<li><p class="first"><a href="#id59"><span class="problematic" id="id60">:meth:`~socket.socket.connect()`</span></a></p>
<div class="system-message" id="id59">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1078); <em><a href="#id60">backlink</a></em></p>
<p>Unknown interpreted text role &quot;meth&quot;.</p>
</div>
</li>
<li><p class="first"><a href="#id61"><span class="problematic" id="id62">:meth:`~socket.socket.detach()`</span></a></p>
<div class="system-message" id="id61">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1079); <em><a href="#id62">backlink</a></em></p>
<p>Unknown interpreted text role &quot;meth&quot;.</p>
</div>
</li>
<li><p class="first"><a href="#id63"><span class="problematic" id="id64">:meth:`~socket.socket.fileno()`</span></a></p>
<div class="system-message" id="id63">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1080); <em><a href="#id64">backlink</a></em></p>
<p>Unknown interpreted text role &quot;meth&quot;.</p>
</div>
</li>
<li><p class="first"><a href="#id65"><span class="problematic" id="id66">:meth:`~socket.socket.getpeername()`</span></a>, <a href="#id67"><span class="problematic" id="id68">:meth:`~socket.socket.getsockname()`</span></a></p>
<div class="system-message" id="id65">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1081); <em><a href="#id66">backlink</a></em></p>
<p>Unknown interpreted text role &quot;meth&quot;.</p>
</div>
<div class="system-message" id="id67">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1081); <em><a href="#id68">backlink</a></em></p>
<p>Unknown interpreted text role &quot;meth&quot;.</p>
</div>
</li>
<li><p class="first"><a href="#id69"><span class="problematic" id="id70">:meth:`~socket.socket.getsockopt()`</span></a>, <a href="#id71"><span class="problematic" id="id72">:meth:`~socket.socket.setsockopt()`</span></a></p>
<div class="system-message" id="id69">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1082); <em><a href="#id70">backlink</a></em></p>
<p>Unknown interpreted text role &quot;meth&quot;.</p>
</div>
<div class="system-message" id="id71">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1082); <em><a href="#id72">backlink</a></em></p>
<p>Unknown interpreted text role &quot;meth&quot;.</p>
</div>
</li>
<li><p class="first"><a href="#id73"><span class="problematic" id="id74">:meth:`~socket.socket.gettimeout()`</span></a>, <a href="#id75"><span class="problematic" id="id76">:meth:`~socket.socket.settimeout()`</span></a>,
<a href="#id77"><span class="problematic" id="id78">:meth:`~socket.socket.setblocking()`</span></a></p>
<div class="system-message" id="id73">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1083); <em><a href="#id74">backlink</a></em></p>
<p>Unknown interpreted text role &quot;meth&quot;.</p>
</div>
<div class="system-message" id="id75">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1083); <em><a href="#id76">backlink</a></em></p>
<p>Unknown interpreted text role &quot;meth&quot;.</p>
</div>
<div class="system-message" id="id77">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1083); <em><a href="#id78">backlink</a></em></p>
<p>Unknown interpreted text role &quot;meth&quot;.</p>
</div>
</li>
<li><p class="first"><a href="#id79"><span class="problematic" id="id80">:meth:`~socket.socket.listen()`</span></a></p>
<div class="system-message" id="id79">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1085); <em><a href="#id80">backlink</a></em></p>
<p>Unknown interpreted text role &quot;meth&quot;.</p>
</div>
</li>
<li><p class="first"><a href="#id81"><span class="problematic" id="id82">:meth:`~socket.socket.makefile()`</span></a></p>
<div class="system-message" id="id81">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1086); <em><a href="#id82">backlink</a></em></p>
<p>Unknown interpreted text role &quot;meth&quot;.</p>
</div>
</li>
<li><p class="first"><a href="#id83"><span class="problematic" id="id84">:meth:`~socket.socket.recv()`</span></a>, <a href="#id85"><span class="problematic" id="id86">:meth:`~socket.socket.recv_into()`</span></a>
(but passing a non-zero <tt class="docutils literal">flags</tt> argument is not allowed)</p>
<div class="system-message" id="id83">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1087); <em><a href="#id84">backlink</a></em></p>
<p>Unknown interpreted text role &quot;meth&quot;.</p>
</div>
<div class="system-message" id="id85">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1087); <em><a href="#id86">backlink</a></em></p>
<p>Unknown interpreted text role &quot;meth&quot;.</p>
</div>
</li>
<li><p class="first"><a href="#id87"><span class="problematic" id="id88">:meth:`~socket.socket.send()`</span></a>, <a href="#id89"><span class="problematic" id="id90">:meth:`~socket.socket.sendall()`</span></a> (with
the same limitation)</p>
<div class="system-message" id="id87">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1089); <em><a href="#id88">backlink</a></em></p>
<p>Unknown interpreted text role &quot;meth&quot;.</p>
</div>
<div class="system-message" id="id89">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1089); <em><a href="#id90">backlink</a></em></p>
<p>Unknown interpreted text role &quot;meth&quot;.</p>
</div>
</li>
<li><p class="first"><a href="#id91"><span class="problematic" id="id92">:meth:`~socket.socket.sendfile()`</span></a> (but <a href="#id93"><span class="problematic" id="id94">:mod:`os.sendfile`</span></a> will be used
for plain-text sockets only, else <a href="#id95"><span class="problematic" id="id96">:meth:`~socket.socket.send()`</span></a> will be used)</p>
<div class="system-message" id="id91">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1091); <em><a href="#id92">backlink</a></em></p>
<p>Unknown interpreted text role &quot;meth&quot;.</p>
</div>
<div class="system-message" id="id93">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1091); <em><a href="#id94">backlink</a></em></p>
<p>Unknown interpreted text role &quot;mod&quot;.</p>
</div>
<div class="system-message" id="id95">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1091); <em><a href="#id96">backlink</a></em></p>
<p>Unknown interpreted text role &quot;meth&quot;.</p>
</div>
</li>
<li><p class="first"><a href="#id97"><span class="problematic" id="id98">:meth:`~socket.socket.shutdown()`</span></a></p>
<div class="system-message" id="id97">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1093); <em><a href="#id98">backlink</a></em></p>
<p>Unknown interpreted text role &quot;meth&quot;.</p>
</div>
</li>
</ul>
<p class="sslsocket-socket-socket">However, since the SSL (and TLS) protocol has its own framing atop
of TCP, the SSL sockets abstraction can, in certain respects, diverge from
the specification of normal, OS-level sockets.  See especially the
<a href="#id99"><span class="problematic" id="id100">:ref:`notes on non-blocking sockets &lt;ssl-nonblocking&gt;`</span></a>.</p>
<div class="sslsocket-socket-socket system-message" id="id99">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1095); <em><a href="#id100">backlink</a></em></p>
Unknown interpreted text role &quot;ref&quot;.</div>
<p class="sslsocket-socket-socket">Instances of <a href="#id101"><span class="problematic" id="id102">:class:`SSLSocket`</span></a> must be created using the
<a href="#id103"><span class="problematic" id="id104">:meth:`SSLContext.wrap_socket`</span></a> method.</p>
<div class="sslsocket-socket-socket system-message" id="id101">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1100); <em><a href="#id102">backlink</a></em></p>
Unknown interpreted text role &quot;class&quot;.</div>
<div class="sslsocket-socket-socket system-message" id="id103">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1100); <em><a href="#id104">backlink</a></em></p>
Unknown interpreted text role &quot;meth&quot;.</div>
<div class="sslsocket-socket-socket system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1103)</p>
<p>Unknown directive type &quot;versionchanged&quot;.</p>
<pre class="literal-block">
.. versionchanged:: 3.5
   The :meth:`sendfile` method was added.

</pre>
</div>
<div class="sslsocket-socket-socket system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1106)</p>
<p>Unknown directive type &quot;versionchanged&quot;.</p>
<pre class="literal-block">
.. versionchanged:: 3.5
   The :meth:`shutdown` does not reset the socket timeout each time bytes
   are received or sent. The socket timeout is now to maximum total duration
   of the shutdown.

</pre>
</div>
<div class="sslsocket-socket-socket system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1111)</p>
<p>Unknown directive type &quot;deprecated&quot;.</p>
<pre class="literal-block">
.. deprecated:: 3.6
   It is deprecated to create a :class:`SSLSocket` instance directly, use
   :meth:`SSLContext.wrap_socket` to wrap a socket.

</pre>
</div>
<div class="sslsocket-socket-socket system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1115)</p>
<p>Unknown directive type &quot;versionchanged&quot;.</p>
<pre class="literal-block">
.. versionchanged:: 3.7
   :class:`SSLSocket` instances must to created with
   :meth:`~SSLContext.wrap_socket`. In earlier versions, it was possible
   to create instances directly. This was never documented or officially
   supported.
</pre>
</div>
<p>SSL sockets also have the following additional methods and attributes:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1123)</p>
<p>Unknown directive type &quot;method&quot;.</p>
<pre class="literal-block">
.. method:: SSLSocket.read(len=1024, buffer=None)

   Read up to *len* bytes of data from the SSL socket and return the result as
   a ``bytes`` instance. If *buffer* is specified, then read into the buffer
   instead, and return the number of bytes read.

   Raise :exc:`SSLWantReadError` or :exc:`SSLWantWriteError` if the socket is
   :ref:`non-blocking &lt;ssl-nonblocking&gt;` and the read would block.

   As at any time a re-negotiation is possible, a call to :meth:`read` can also
   cause write operations.

   .. versionchanged:: 3.5
      The socket timeout is no more reset each time bytes are received or sent.
      The socket timeout is now to maximum total duration to read up to *len*
      bytes.

   .. deprecated:: 3.6
      Use :meth:`~SSLSocket.recv` instead of :meth:`~SSLSocket.read`.

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1143)</p>
<p>Unknown directive type &quot;method&quot;.</p>
<pre class="literal-block">
.. method:: SSLSocket.write(buf)

   Write *buf* to the SSL socket and return the number of bytes written. The
   *buf* argument must be an object supporting the buffer interface.

   Raise :exc:`SSLWantReadError` or :exc:`SSLWantWriteError` if the socket is
   :ref:`non-blocking &lt;ssl-nonblocking&gt;` and the write would block.

   As at any time a re-negotiation is possible, a call to :meth:`write` can
   also cause read operations.

   .. versionchanged:: 3.5
      The socket timeout is no more reset each time bytes are received or sent.
      The socket timeout is now to maximum total duration to write *buf*.

   .. deprecated:: 3.6
      Use :meth:`~SSLSocket.send` instead of :meth:`~SSLSocket.write`.

</pre>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The <a href="#id105"><span class="problematic" id="id106">:meth:`~SSLSocket.read`</span></a> and <a href="#id107"><span class="problematic" id="id108">:meth:`~SSLSocket.write`</span></a> methods are the
low-level methods that read and write unencrypted, application-level data
and decrypt/encrypt it to encrypted, wire-level data. These methods
require an active SSL connection, i.e. the handshake was completed and
<a href="#id109"><span class="problematic" id="id110">:meth:`SSLSocket.unwrap`</span></a> was not called.</p>
<div class="system-message" id="id105">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1163); <em><a href="#id106">backlink</a></em></p>
Unknown interpreted text role &quot;meth&quot;.</div>
<div class="system-message" id="id107">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1163); <em><a href="#id108">backlink</a></em></p>
Unknown interpreted text role &quot;meth&quot;.</div>
<div class="system-message" id="id109">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1163); <em><a href="#id110">backlink</a></em></p>
Unknown interpreted text role &quot;meth&quot;.</div>
<p>Normally you should use the socket API methods like
<a href="#id111"><span class="problematic" id="id112">:meth:`~socket.socket.recv`</span></a> and <a href="#id113"><span class="problematic" id="id114">:meth:`~socket.socket.send`</span></a> instead of these
methods.</p>
<div class="system-message" id="id111">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1169); <em><a href="#id112">backlink</a></em></p>
Unknown interpreted text role &quot;meth&quot;.</div>
<div class="last system-message" id="id113">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1169); <em><a href="#id114">backlink</a></em></p>
Unknown interpreted text role &quot;meth&quot;.</div>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1173)</p>
<p>Unknown directive type &quot;method&quot;.</p>
<pre class="literal-block">
.. method:: SSLSocket.do_handshake()

   Perform the SSL setup handshake.

   .. versionchanged:: 3.4
      The handshake method also performs :func:`match_hostname` when the
      :attr:`~SSLContext.check_hostname` attribute of the socket's
      :attr:`~SSLSocket.context` is true.

   .. versionchanged:: 3.5
      The socket timeout is no more reset each time bytes are received or sent.
      The socket timeout is now to maximum total duration of the handshake.

   .. versionchanged:: 3.7
      Hostname or IP address is matched by OpenSSL during handshake. The
      function :func:`match_hostname` is no longer used. In case OpenSSL
      refuses a hostname or IP address, the handshake is aborted early and
      a TLS alert message is send to the peer.

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1192)</p>
<p>Unknown directive type &quot;method&quot;.</p>
<pre class="literal-block">
.. method:: SSLSocket.getpeercert(binary_form=False)

   If there is no certificate for the peer on the other end of the connection,
   return ``None``.  If the SSL handshake hasn't been done yet, raise
   :exc:`ValueError`.

   If the ``binary_form`` parameter is :const:`False`, and a certificate was
   received from the peer, this method returns a :class:`dict` instance.  If the
   certificate was not validated, the dict is empty.  If the certificate was
   validated, it returns a dict with several keys, amongst them ``subject``
   (the principal for which the certificate was issued) and ``issuer``
   (the principal issuing the certificate).  If a certificate contains an
   instance of the *Subject Alternative Name* extension (see :rfc:`3280`),
   there will also be a ``subjectAltName`` key in the dictionary.

   The ``subject`` and ``issuer`` fields are tuples containing the sequence
   of relative distinguished names (RDNs) given in the certificate's data
   structure for the respective fields, and each RDN is a sequence of
   name-value pairs.  Here is a real-world example::

      {'issuer': ((('countryName', 'IL'),),
                  (('organizationName', 'StartCom Ltd.'),),
                  (('organizationalUnitName',
                    'Secure Digital Certificate Signing'),),
                  (('commonName',
                    'StartCom Class 2 Primary Intermediate Server CA'),)),
       'notAfter': 'Nov 22 08:15:19 2013 GMT',
       'notBefore': 'Nov 21 03:09:52 2011 GMT',
       'serialNumber': '95F0',
       'subject': ((('description', '571208-SLe257oHY9fVQ07Z'),),
                   (('countryName', 'US'),),
                   (('stateOrProvinceName', 'California'),),
                   (('localityName', 'San Francisco'),),
                   (('organizationName', 'Electronic Frontier Foundation, Inc.'),),
                   (('commonName', '*.eff.org'),),
                   (('emailAddress', 'hostmaster&#64;eff.org'),)),
       'subjectAltName': (('DNS', '*.eff.org'), ('DNS', 'eff.org')),
       'version': 3}

   .. note::

      To validate a certificate for a particular service, you can use the
      :func:`match_hostname` function.

   If the ``binary_form`` parameter is :const:`True`, and a certificate was
   provided, this method returns the DER-encoded form of the entire certificate
   as a sequence of bytes, or :const:`None` if the peer did not provide a
   certificate.  Whether the peer provides a certificate depends on the SSL
   socket's role:

   * for a client SSL socket, the server will always provide a certificate,
     regardless of whether validation was required;

   * for a server SSL socket, the client will only provide a certificate
     when requested by the server; therefore :meth:`getpeercert` will return
     :const:`None` if you used :const:`CERT_NONE` (rather than
     :const:`CERT_OPTIONAL` or :const:`CERT_REQUIRED`).

   .. versionchanged:: 3.2
      The returned dictionary includes additional items such as ``issuer``
      and ``notBefore``.

   .. versionchanged:: 3.4
      :exc:`ValueError` is raised when the handshake isn't done.
      The returned dictionary includes additional X509v3 extension items
        such as ``crlDistributionPoints``, ``caIssuers`` and ``OCSP`` URIs.

   .. versionchanged:: 3.9
      IPv6 address strings no longer have a trailing new line.

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1262)</p>
<p>Unknown directive type &quot;method&quot;.</p>
<pre class="literal-block">
.. method:: SSLSocket.cipher()

   Returns a three-value tuple containing the name of the cipher being used, the
   version of the SSL protocol that defines its use, and the number of secret
   bits being used.  If no connection has been established, returns ``None``.

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1268)</p>
<p>Unknown directive type &quot;method&quot;.</p>
<pre class="literal-block">
.. method:: SSLSocket.shared_ciphers()

   Return the list of ciphers shared by the client during the handshake.  Each
   entry of the returned list is a three-value tuple containing the name of the
   cipher, the version of the SSL protocol that defines its use, and the number
   of secret bits the cipher uses.  :meth:`~SSLSocket.shared_ciphers` returns
   ``None`` if no connection has been established or the socket is a client
   socket.

   .. versionadded:: 3.5

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1279)</p>
<p>Unknown directive type &quot;method&quot;.</p>
<pre class="literal-block">
.. method:: SSLSocket.compression()

   Return the compression algorithm being used as a string, or ``None``
   if the connection isn't compressed.

   If the higher-level protocol supports its own compression mechanism,
   you can use :data:`OP_NO_COMPRESSION` to disable SSL-level compression.

   .. versionadded:: 3.3

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1289)</p>
<p>Unknown directive type &quot;method&quot;.</p>
<pre class="literal-block">
.. method:: SSLSocket.get_channel_binding(cb_type=&quot;tls-unique&quot;)

   Get channel binding data for current connection, as a bytes object.  Returns
   ``None`` if not connected or the handshake has not been completed.

   The *cb_type* parameter allow selection of the desired channel binding
   type. Valid channel binding types are listed in the
   :data:`CHANNEL_BINDING_TYPES` list.  Currently only the 'tls-unique' channel
   binding, defined by :rfc:`5929`, is supported.  :exc:`ValueError` will be
   raised if an unsupported channel binding type is requested.

   .. versionadded:: 3.3

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1302)</p>
<p>Unknown directive type &quot;method&quot;.</p>
<pre class="literal-block">
.. method:: SSLSocket.selected_alpn_protocol()

   Return the protocol that was selected during the TLS handshake.  If
   :meth:`SSLContext.set_alpn_protocols` was not called, if the other party does
   not support ALPN, if this socket does not support any of the client's
   proposed protocols, or if the handshake has not happened yet, ``None`` is
   returned.

   .. versionadded:: 3.5

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1312)</p>
<p>Unknown directive type &quot;method&quot;.</p>
<pre class="literal-block">
.. method:: SSLSocket.selected_npn_protocol()

   Return the higher-level protocol that was selected during the TLS/SSL
   handshake. If :meth:`SSLContext.set_npn_protocols` was not called, or
   if the other party does not support NPN, or if the handshake has not yet
   happened, this will return ``None``.

   .. versionadded:: 3.3

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1321)</p>
<p>Unknown directive type &quot;method&quot;.</p>
<pre class="literal-block">
.. method:: SSLSocket.unwrap()

   Performs the SSL shutdown handshake, which removes the TLS layer from the
   underlying socket, and returns the underlying socket object.  This can be
   used to go from encrypted operation over a connection to unencrypted.  The
   returned socket should always be used for further communication with the
   other side of the connection, rather than the original socket.

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1329)</p>
<p>Unknown directive type &quot;method&quot;.</p>
<pre class="literal-block">
.. method:: SSLSocket.verify_client_post_handshake()

   Requests post-handshake authentication (PHA) from a TLS 1.3 client. PHA
   can only be initiated for a TLS 1.3 connection from a server-side socket,
   after the initial TLS handshake and with PHA enabled on both sides, see
   :attr:`SSLContext.post_handshake_auth`.

   The method does not perform a cert exchange immediately. The server-side
   sends a CertificateRequest during the next write event and expects the
   client to respond with a certificate on the next read event.

   If any precondition isn't met (e.g. not TLS 1.3, PHA not enabled), an
   :exc:`SSLError` is raised.

   .. note::
      Only available with OpenSSL 1.1.1 and TLS 1.3 enabled. Without TLS 1.3
      support, the method raises :exc:`NotImplementedError`.

   .. versionadded:: 3.8

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1349)</p>
<p>Unknown directive type &quot;method&quot;.</p>
<pre class="literal-block">
.. method:: SSLSocket.version()

   Return the actual SSL protocol version negotiated by the connection
   as a string, or ``None`` is no secure connection is established.
   As of this writing, possible return values include ``&quot;SSLv2&quot;``,
   ``&quot;SSLv3&quot;``, ``&quot;TLSv1&quot;``, ``&quot;TLSv1.1&quot;`` and ``&quot;TLSv1.2&quot;``.
   Recent OpenSSL versions may define more return values.

   .. versionadded:: 3.5

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1359)</p>
<p>Unknown directive type &quot;method&quot;.</p>
<pre class="literal-block">
.. method:: SSLSocket.pending()

   Returns the number of already decrypted bytes available for read, pending on
   the connection.

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1364)</p>
<p>Unknown directive type &quot;attribute&quot;.</p>
<pre class="literal-block">
.. attribute:: SSLSocket.context

   The :class:`SSLContext` object this SSL socket is tied to.  If the SSL
   socket was created using the deprecated :func:`wrap_socket` function
   (rather than :meth:`SSLContext.wrap_socket`), this is a custom context
   object created for this SSL socket.

   .. versionadded:: 3.2

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1373)</p>
<p>Unknown directive type &quot;attribute&quot;.</p>
<pre class="literal-block">
.. attribute:: SSLSocket.server_side

   A boolean which is ``True`` for server-side sockets and ``False`` for
   client-side sockets.

   .. versionadded:: 3.2

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1380)</p>
<p>Unknown directive type &quot;attribute&quot;.</p>
<pre class="literal-block">
.. attribute:: SSLSocket.server_hostname

   Hostname of the server: :class:`str` type, or ``None`` for server-side
   socket or if the hostname was not specified in the constructor.

   .. versionadded:: 3.2

   .. versionchanged:: 3.7
      The attribute is now always ASCII text. When ``server_hostname`` is
      an internationalized domain name (IDN), this attribute now stores the
      A-label form (``&quot;xn--pythn-mua.org&quot;``), rather than the U-label form
      (``&quot;pythn.org&quot;``).

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1393)</p>
<p>Unknown directive type &quot;attribute&quot;.</p>
<pre class="literal-block">
.. attribute:: SSLSocket.session

   The :class:`SSLSession` for this SSL connection. The session is available
   for client and server side sockets after the TLS handshake has been
   performed. For client sockets the session can be set before
   :meth:`~SSLSocket.do_handshake` has been called to reuse a session.

   .. versionadded:: 3.6

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1402)</p>
<p>Unknown directive type &quot;attribute&quot;.</p>
<pre class="literal-block">
.. attribute:: SSLSocket.session_reused

   .. versionadded:: 3.6


</pre>
</div>
</div>
<div class="section" id="ssl-contexts">
<h1>SSL Contexts</h1>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1410)</p>
<p>Unknown directive type &quot;versionadded&quot;.</p>
<pre class="literal-block">
.. versionadded:: 3.2

</pre>
</div>
<p>An SSL context holds various data longer-lived than single SSL connections,
such as SSL configuration options, certificate(s) and private key(s).
It also manages a cache of SSL sessions for server-side sockets, in order
to speed up repeated connections from the same clients.</p>
<p class="sslcontext-protocol-protocol-tls">Create a new SSL context.  You may pass <em>protocol</em> which must be one
of the <tt class="docutils literal">PROTOCOL_*</tt> constants defined in this module.  The parameter
specifies which version of the SSL protocol to use.  Typically, the
server chooses a particular protocol version, and the client must adapt
to the server's choice.  Most of the versions are not interoperable
with the other versions.  If not specified, the default is
<a href="#id115"><span class="problematic" id="id116">:data:`PROTOCOL_TLS`</span></a>; it provides the most compatibility with other
versions.</p>
<div class="sslcontext-protocol-protocol-tls system-message" id="id115">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1419); <em><a href="#id116">backlink</a></em></p>
Unknown interpreted text role &quot;data&quot;.</div>
<p class="sslcontext-protocol-protocol-tls">Here's a table showing which versions in a client (down the side) can connect
to which versions in a server (along the top):</p>
<blockquote class="sslcontext-protocol-protocol-tls">
<table border="1" class="docutils">
<colgroup>
<col width="26%" />
<col width="13%" />
<col width="13%" />
<col width="14%" />
<col width="10%" />
<col width="12%" />
<col width="12%" />
</colgroup>
<tbody valign="top">
<tr><td><em>client</em> / <strong>server</strong></td>
<td><strong>SSLv2</strong></td>
<td><strong>SSLv3</strong></td>
<td><strong>TLS</strong> <a class="footnote-reference" href="#id133" id="id117">[3]</a></td>
<td><strong>TLSv1</strong></td>
<td><strong>TLSv1.1</strong></td>
<td><strong>TLSv1.2</strong></td>
</tr>
<tr><td><em>SSLv2</em></td>
<td>yes</td>
<td>no</td>
<td>no <a class="footnote-reference" href="#id123" id="id118">[1]</a></td>
<td>no</td>
<td>no</td>
<td>no</td>
</tr>
<tr><td><em>SSLv3</em></td>
<td>no</td>
<td>yes</td>
<td>no <a class="footnote-reference" href="#id128" id="id119">[2]</a></td>
<td>no</td>
<td>no</td>
<td>no</td>
</tr>
<tr><td><em>TLS</em> (<em>SSLv23</em>) <a class="footnote-reference" href="#id133" id="id120">[3]</a></td>
<td>no <a class="footnote-reference" href="#id123" id="id121">[1]</a></td>
<td>no <a class="footnote-reference" href="#id128" id="id122">[2]</a></td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
</tr>
<tr><td><em>TLSv1</em></td>
<td>no</td>
<td>no</td>
<td>yes</td>
<td>yes</td>
<td>no</td>
<td>no</td>
</tr>
<tr><td><em>TLSv1.1</em></td>
<td>no</td>
<td>no</td>
<td>yes</td>
<td>no</td>
<td>yes</td>
<td>no</td>
</tr>
<tr><td><em>TLSv1.2</em></td>
<td>no</td>
<td>no</td>
<td>yes</td>
<td>no</td>
<td>no</td>
<td>yes</td>
</tr>
</tbody>
</table>
</blockquote>
<p class="sslcontext-protocol-protocol-tls rubric">Footnotes</p>
<table class="sslcontext-protocol-protocol-tls docutils footnote" frame="void" id="id123" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td><em>(<a class="fn-backref" href="#id118">1</a>, <a class="fn-backref" href="#id121">2</a>)</em> <p><a href="#id124"><span class="problematic" id="id125">:class:`SSLContext`</span></a> disables SSLv2 with <a href="#id126"><span class="problematic" id="id127">:data:`OP_NO_SSLv2`</span></a> by default.</p>
<div class="system-message" id="id124">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1445); <em><a href="#id125">backlink</a></em></p>
Unknown interpreted text role &quot;class&quot;.</div>
<div class="last system-message" id="id126">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1445); <em><a href="#id127">backlink</a></em></p>
Unknown interpreted text role &quot;data&quot;.</div>
</td></tr>
</tbody>
</table>
<table class="sslcontext-protocol-protocol-tls docutils footnote" frame="void" id="id128" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[2]</td><td><em>(<a class="fn-backref" href="#id119">1</a>, <a class="fn-backref" href="#id122">2</a>)</em> <p><a href="#id129"><span class="problematic" id="id130">:class:`SSLContext`</span></a> disables SSLv3 with <a href="#id131"><span class="problematic" id="id132">:data:`OP_NO_SSLv3`</span></a> by default.</p>
<div class="system-message" id="id129">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1446); <em><a href="#id130">backlink</a></em></p>
Unknown interpreted text role &quot;class&quot;.</div>
<div class="last system-message" id="id131">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1446); <em><a href="#id132">backlink</a></em></p>
Unknown interpreted text role &quot;data&quot;.</div>
</td></tr>
</tbody>
</table>
<table class="sslcontext-protocol-protocol-tls docutils footnote" frame="void" id="id133" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[3]</td><td><em>(<a class="fn-backref" href="#id117">1</a>, <a class="fn-backref" href="#id120">2</a>)</em> <p>TLS 1.3 protocol will be available with <a href="#id134"><span class="problematic" id="id135">:data:`PROTOCOL_TLS`</span></a> in
OpenSSL &gt;= 1.1.1. There is no dedicated PROTOCOL constant for just
TLS 1.3.</p>
<div class="last system-message" id="id134">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1447); <em><a href="#id135">backlink</a></em></p>
Unknown interpreted text role &quot;data&quot;.</div>
</td></tr>
</tbody>
</table>
<div class="sslcontext-protocol-protocol-tls system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1451)</p>
<p>Unknown directive type &quot;seealso&quot;.</p>
<pre class="literal-block">
.. seealso::
   :func:`create_default_context` lets the :mod:`ssl` module choose
   security settings for a given purpose.

</pre>
</div>
<div class="sslcontext-protocol-protocol-tls system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1455)</p>
<p>Unknown directive type &quot;versionchanged&quot;.</p>
<pre class="literal-block">
.. versionchanged:: 3.6

   The context is created with secure default values. The options
   :data:`OP_NO_COMPRESSION`, :data:`OP_CIPHER_SERVER_PREFERENCE`,
   :data:`OP_SINGLE_DH_USE`, :data:`OP_SINGLE_ECDH_USE`,
   :data:`OP_NO_SSLv2` (except for :data:`PROTOCOL_SSLv2`),
   and :data:`OP_NO_SSLv3` (except for :data:`PROTOCOL_SSLv3`) are
   set by default. The initial cipher suite list contains only ``HIGH``
   ciphers, no ``NULL`` ciphers and no ``MD5`` ciphers (except for
   :data:`PROTOCOL_SSLv2`).
</pre>
</div>
<p><a href="#id136"><span class="problematic" id="id137">:class:`SSLContext`</span></a> objects have the following methods and attributes:</p>
<div class="system-message" id="id136">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1467); <em><a href="#id137">backlink</a></em></p>
Unknown interpreted text role &quot;class&quot;.</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1469)</p>
<p>Unknown directive type &quot;method&quot;.</p>
<pre class="literal-block">
.. method:: SSLContext.cert_store_stats()

   Get statistics about quantities of loaded X.509 certificates, count of
   X.509 certificates flagged as CA certificates and certificate revocation
   lists as dictionary.

   Example for a context with one CA cert and one other cert::

      &gt;&gt;&gt; context.cert_store_stats()
      {'crl': 0, 'x509_ca': 1, 'x509': 2}

   .. versionadded:: 3.4


</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1483)</p>
<p>Unknown directive type &quot;method&quot;.</p>
<pre class="literal-block">
.. method:: SSLContext.load_cert_chain(certfile, keyfile=None, password=None)

   Load a private key and the corresponding certificate.  The *certfile*
   string must be the path to a single file in PEM format containing the
   certificate as well as any number of CA certificates needed to establish
   the certificate's authenticity.  The *keyfile* string, if present, must
   point to a file containing the private key in.  Otherwise the private
   key will be taken from *certfile* as well.  See the discussion of
   :ref:`ssl-certificates` for more information on how the certificate
   is stored in the *certfile*.

   The *password* argument may be a function to call to get the password for
   decrypting the private key.  It will only be called if the private key is
   encrypted and a password is necessary.  It will be called with no arguments,
   and it should return a string, bytes, or bytearray.  If the return value is
   a string it will be encoded as UTF-8 before using it to decrypt the key.
   Alternatively a string, bytes, or bytearray value may be supplied directly
   as the *password* argument.  It will be ignored if the private key is not
   encrypted and no password is needed.

   If the *password* argument is not specified and a password is required,
   OpenSSL's built-in password prompting mechanism will be used to
   interactively prompt the user for a password.

   An :class:`SSLError` is raised if the private key doesn't
   match with the certificate.

   .. versionchanged:: 3.3
      New optional argument *password*.

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1513)</p>
<p>Unknown directive type &quot;method&quot;.</p>
<pre class="literal-block">
.. method:: SSLContext.load_default_certs(purpose=Purpose.SERVER_AUTH)

   Load a set of default &quot;certification authority&quot; (CA) certificates from
   default locations. On Windows it loads CA certs from the ``CA`` and
   ``ROOT`` system stores. On other systems it calls
   :meth:`SSLContext.set_default_verify_paths`. In the future the method may
   load CA certificates from other locations, too.

   The *purpose* flag specifies what kind of CA certificates are loaded. The
   default settings :data:`Purpose.SERVER_AUTH` loads certificates, that are
   flagged and trusted for TLS web server authentication (client side
   sockets). :data:`Purpose.CLIENT_AUTH` loads CA certificates for client
   certificate verification on the server side.

   .. versionadded:: 3.4

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1529)</p>
<p>Unknown directive type &quot;method&quot;.</p>
<pre class="literal-block">
.. method:: SSLContext.load_verify_locations(cafile=None, capath=None, cadata=None)

   Load a set of &quot;certification authority&quot; (CA) certificates used to validate
   other peers' certificates when :data:`verify_mode` is other than
   :data:`CERT_NONE`.  At least one of *cafile* or *capath* must be specified.

   This method can also load certification revocation lists (CRLs) in PEM or
   DER format. In order to make use of CRLs, :attr:`SSLContext.verify_flags`
   must be configured properly.

   The *cafile* string, if present, is the path to a file of concatenated
   CA certificates in PEM format. See the discussion of
   :ref:`ssl-certificates` for more information about how to arrange the
   certificates in this file.

   The *capath* string, if present, is
   the path to a directory containing several CA certificates in PEM format,
   following an `OpenSSL specific layout
   &lt;https://www.openssl.org/docs/manmaster/man3/SSL_CTX_load_verify_locations.html&gt;`_.

   The *cadata* object, if present, is either an ASCII string of one or more
   PEM-encoded certificates or a :term:`bytes-like object` of DER-encoded
   certificates. Like with *capath* extra lines around PEM-encoded
   certificates are ignored but at least one certificate must be present.

   .. versionchanged:: 3.4
      New optional argument *cadata*

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1557)</p>
<p>Unknown directive type &quot;method&quot;.</p>
<pre class="literal-block">
.. method:: SSLContext.get_ca_certs(binary_form=False)

   Get a list of loaded &quot;certification authority&quot; (CA) certificates. If the
   ``binary_form`` parameter is :const:`False` each list
   entry is a dict like the output of :meth:`SSLSocket.getpeercert`. Otherwise
   the method returns a list of DER-encoded certificates. The returned list
   does not contain certificates from *capath* unless a certificate was
   requested and loaded by a SSL connection.

   .. note::
      Certificates in a capath directory aren't loaded unless they have
      been used at least once.

   .. versionadded:: 3.4

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1572)</p>
<p>Unknown directive type &quot;method&quot;.</p>
<pre class="literal-block">
.. method:: SSLContext.get_ciphers()

   Get a list of enabled ciphers. The list is in order of cipher priority.
   See :meth:`SSLContext.set_ciphers`.

   Example::

       &gt;&gt;&gt; ctx = ssl.SSLContext(ssl.PROTOCOL_SSLv23)
       &gt;&gt;&gt; ctx.set_ciphers('ECDHE+AESGCM:!ECDSA')
       &gt;&gt;&gt; ctx.get_ciphers()  # OpenSSL 1.0.x
       [{'alg_bits': 256,
         'description': 'ECDHE-RSA-AES256-GCM-SHA384 TLSv1.2 Kx=ECDH     Au=RSA  '
                        'Enc=AESGCM(256) Mac=AEAD',
         'id': 50380848,
         'name': 'ECDHE-RSA-AES256-GCM-SHA384',
         'protocol': 'TLSv1/SSLv3',
         'strength_bits': 256},
        {'alg_bits': 128,
         'description': 'ECDHE-RSA-AES128-GCM-SHA256 TLSv1.2 Kx=ECDH     Au=RSA  '
                        'Enc=AESGCM(128) Mac=AEAD',
         'id': 50380847,
         'name': 'ECDHE-RSA-AES128-GCM-SHA256',
         'protocol': 'TLSv1/SSLv3',
         'strength_bits': 128}]

   On OpenSSL 1.1 and newer the cipher dict contains additional fields::

       &gt;&gt;&gt; ctx.get_ciphers()  # OpenSSL 1.1+
       [{'aead': True,
         'alg_bits': 256,
         'auth': 'auth-rsa',
         'description': 'ECDHE-RSA-AES256-GCM-SHA384 TLSv1.2 Kx=ECDH     Au=RSA  '
                        'Enc=AESGCM(256) Mac=AEAD',
         'digest': None,
         'id': 50380848,
         'kea': 'kx-ecdhe',
         'name': 'ECDHE-RSA-AES256-GCM-SHA384',
         'protocol': 'TLSv1.2',
         'strength_bits': 256,
         'symmetric': 'aes-256-gcm'},
        {'aead': True,
         'alg_bits': 128,
         'auth': 'auth-rsa',
         'description': 'ECDHE-RSA-AES128-GCM-SHA256 TLSv1.2 Kx=ECDH     Au=RSA  '
                        'Enc=AESGCM(128) Mac=AEAD',
         'digest': None,
         'id': 50380847,
         'kea': 'kx-ecdhe',
         'name': 'ECDHE-RSA-AES128-GCM-SHA256',
         'protocol': 'TLSv1.2',
         'strength_bits': 128,
         'symmetric': 'aes-128-gcm'}]

   .. availability:: OpenSSL 1.0.2+.

   .. versionadded:: 3.6

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1629)</p>
<p>Unknown directive type &quot;method&quot;.</p>
<pre class="literal-block">
.. method:: SSLContext.set_default_verify_paths()

   Load a set of default &quot;certification authority&quot; (CA) certificates from
   a filesystem path defined when building the OpenSSL library.  Unfortunately,
   there's no easy way to know whether this method succeeds: no error is
   returned if no certificates are to be found.  When the OpenSSL library is
   provided as part of the operating system, though, it is likely to be
   configured properly.

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1638)</p>
<p>Unknown directive type &quot;method&quot;.</p>
<pre class="literal-block">
.. method:: SSLContext.set_ciphers(ciphers)

   Set the available ciphers for sockets created with this context.
   It should be a string in the `OpenSSL cipher list format
   &lt;https://www.openssl.org/docs/manmaster/man1/ciphers.html&gt;`_.
   If no cipher can be selected (because compile-time options or other
   configuration forbids use of all the specified ciphers), an
   :class:`SSLError` will be raised.

   .. note::
      when connected, the :meth:`SSLSocket.cipher` method of SSL sockets will
      give the currently selected cipher.

      OpenSSL 1.1.1 has TLS 1.3 cipher suites enabled by default. The suites
      cannot be disabled with :meth:`~SSLContext.set_ciphers`.

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1654)</p>
<p>Unknown directive type &quot;method&quot;.</p>
<pre class="literal-block">
.. method:: SSLContext.set_alpn_protocols(protocols)

   Specify which protocols the socket should advertise during the SSL/TLS
   handshake. It should be a list of ASCII strings, like ``['http/1.1',
   'spdy/2']``, ordered by preference. The selection of a protocol will happen
   during the handshake, and will play out according to :rfc:`7301`. After a
   successful handshake, the :meth:`SSLSocket.selected_alpn_protocol` method will
   return the agreed-upon protocol.

   This method will raise :exc:`NotImplementedError` if :data:`HAS_ALPN` is
   ``False``.

   OpenSSL 1.1.0 to 1.1.0e will abort the handshake and raise :exc:`SSLError`
   when both sides support ALPN but cannot agree on a protocol. 1.1.0f+
   behaves like 1.0.2, :meth:`SSLSocket.selected_alpn_protocol` returns None.

   .. versionadded:: 3.5

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1672)</p>
<p>Unknown directive type &quot;method&quot;.</p>
<pre class="literal-block">
.. method:: SSLContext.set_npn_protocols(protocols)

   Specify which protocols the socket should advertise during the SSL/TLS
   handshake. It should be a list of strings, like ``['http/1.1', 'spdy/2']``,
   ordered by preference. The selection of a protocol will happen during the
   handshake, and will play out according to the `Application Layer Protocol Negotiation
   &lt;https://en.wikipedia.org/wiki/Application-Layer_Protocol_Negotiation&gt;`_. After a
   successful handshake, the :meth:`SSLSocket.selected_npn_protocol` method will
   return the agreed-upon protocol.

   This method will raise :exc:`NotImplementedError` if :data:`HAS_NPN` is
   ``False``.

   .. versionadded:: 3.3

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1687)</p>
<p>Unknown directive type &quot;attribute&quot;.</p>
<pre class="literal-block">
.. attribute:: SSLContext.sni_callback

   Register a callback function that will be called after the TLS Client Hello
   handshake message has been received by the SSL/TLS server when the TLS client
   specifies a server name indication. The server name indication mechanism
   is specified in :rfc:`6066` section 3 - Server Name Indication.

   Only one callback can be set per ``SSLContext``.  If *sni_callback*
   is set to ``None`` then the callback is disabled. Calling this function a
   subsequent time will disable the previously registered callback.

   The callback function will be called with three
   arguments; the first being the :class:`ssl.SSLSocket`, the second is a string
   that represents the server name that the client is intending to communicate
   (or :const:`None` if the TLS Client Hello does not contain a server name)
   and the third argument is the original :class:`SSLContext`. The server name
   argument is text. For internationalized domain name, the server
   name is an IDN A-label (``&quot;xn--pythn-mua.org&quot;``).

   A typical use of this callback is to change the :class:`ssl.SSLSocket`'s
   :attr:`SSLSocket.context` attribute to a new object of type
   :class:`SSLContext` representing a certificate chain that matches the server
   name.

   Due to the early negotiation phase of the TLS connection, only limited
   methods and attributes are usable like
   :meth:`SSLSocket.selected_alpn_protocol` and :attr:`SSLSocket.context`.
   :meth:`SSLSocket.getpeercert`, :meth:`SSLSocket.getpeercert`,
   :meth:`SSLSocket.cipher` and :meth:`SSLSocket.compress` methods require that
   the TLS connection has progressed beyond the TLS Client Hello and therefore
   will not contain return meaningful values nor can they be called safely.

   The *sni_callback* function must return ``None`` to allow the
   TLS negotiation to continue.  If a TLS failure is required, a constant
   :const:`ALERT_DESCRIPTION_* &lt;ALERT_DESCRIPTION_INTERNAL_ERROR&gt;` can be
   returned.  Other return values will result in a TLS fatal error with
   :const:`ALERT_DESCRIPTION_INTERNAL_ERROR`.

   If an exception is raised from the *sni_callback* function the TLS
   connection will terminate with a fatal TLS alert message
   :const:`ALERT_DESCRIPTION_HANDSHAKE_FAILURE`.

   This method will raise :exc:`NotImplementedError` if the OpenSSL library
   had OPENSSL_NO_TLSEXT defined when it was built.

   .. versionadded:: 3.7

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1734)</p>
<p>Unknown directive type &quot;attribute&quot;.</p>
<pre class="literal-block">
.. attribute:: SSLContext.set_servername_callback(server_name_callback)

   This is a legacy API retained for backwards compatibility. When possible,
   you should use :attr:`sni_callback` instead. The given *server_name_callback*
   is similar to *sni_callback*, except that when the server hostname is an
   IDN-encoded internationalized domain name, the *server_name_callback*
   receives a decoded U-label (``&quot;pythn.org&quot;``).

   If there is an decoding error on the server name, the TLS connection will
   terminate with an :const:`ALERT_DESCRIPTION_INTERNAL_ERROR` fatal TLS
   alert message to the client.

   .. versionadded:: 3.4

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1748)</p>
<p>Unknown directive type &quot;method&quot;.</p>
<pre class="literal-block">
.. method:: SSLContext.load_dh_params(dhfile)

   Load the key generation parameters for Diffie-Hellman (DH) key exchange.
   Using DH key exchange improves forward secrecy at the expense of
   computational resources (both on the server and on the client).
   The *dhfile* parameter should be the path to a file containing DH
   parameters in PEM format.

   This setting doesn't apply to client sockets.  You can also use the
   :data:`OP_SINGLE_DH_USE` option to further improve security.

   .. versionadded:: 3.3

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1761)</p>
<p>Unknown directive type &quot;method&quot;.</p>
<pre class="literal-block">
.. method:: SSLContext.set_ecdh_curve(curve_name)

   Set the curve name for Elliptic Curve-based Diffie-Hellman (ECDH) key
   exchange.  ECDH is significantly faster than regular DH while arguably
   as secure.  The *curve_name* parameter should be a string describing
   a well-known elliptic curve, for example ``prime256v1`` for a widely
   supported curve.

   This setting doesn't apply to client sockets.  You can also use the
   :data:`OP_SINGLE_ECDH_USE` option to further improve security.

   This method is not available if :data:`HAS_ECDH` is ``False``.

   .. versionadded:: 3.3

   .. seealso::
      `SSL/TLS &amp; Perfect Forward Secrecy &lt;https://vincent.bernat.im/en/blog/2011-ssl-perfect-forward-secrecy&gt;`_
         Vincent Bernat.

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1780)</p>
<p>Unknown directive type &quot;method&quot;.</p>
<pre class="literal-block">
.. method:: SSLContext.wrap_socket(sock, server_side=False, \
      do_handshake_on_connect=True, suppress_ragged_eofs=True, \
      server_hostname=None, session=None)

   Wrap an existing Python socket *sock* and return an instance of
   :attr:`SSLContext.sslsocket_class` (default :class:`SSLSocket`). The
   returned SSL socket is tied to the context, its settings and certificates.
   *sock* must be a :data:`~socket.SOCK_STREAM` socket; other
   socket types are unsupported.

   The parameter ``server_side`` is a boolean which identifies whether
   server-side or client-side behavior is desired from this socket.

   For client-side sockets, the context construction is lazy; if the
   underlying socket isn't connected yet, the context construction will be
   performed after :meth:`connect` is called on the socket.  For
   server-side sockets, if the socket has no remote peer, it is assumed
   to be a listening socket, and the server-side SSL wrapping is
   automatically performed on client connections accepted via the
   :meth:`accept` method. The method may raise :exc:`SSLError`.

   On client connections, the optional parameter *server_hostname* specifies
   the hostname of the service which we are connecting to.  This allows a
   single server to host multiple SSL-based services with distinct certificates,
   quite similarly to HTTP virtual hosts. Specifying *server_hostname* will
   raise a :exc:`ValueError` if *server_side* is true.

   The parameter ``do_handshake_on_connect`` specifies whether to do the SSL
   handshake automatically after doing a :meth:`socket.connect`, or whether the
   application program will call it explicitly, by invoking the
   :meth:`SSLSocket.do_handshake` method.  Calling
   :meth:`SSLSocket.do_handshake` explicitly gives the program control over the
   blocking behavior of the socket I/O involved in the handshake.

   The parameter ``suppress_ragged_eofs`` specifies how the
   :meth:`SSLSocket.recv` method should signal unexpected EOF from the other end
   of the connection.  If specified as :const:`True` (the default), it returns a
   normal EOF (an empty bytes object) in response to unexpected EOF errors
   raised from the underlying socket; if :const:`False`, it will raise the
   exceptions back to the caller.

   *session*, see :attr:`~SSLSocket.session`.

   .. versionchanged:: 3.5
      Always allow a server_hostname to be passed, even if OpenSSL does not
      have SNI.

   .. versionchanged:: 3.6
      *session* argument was added.

    .. versionchanged:: 3.7
      The method returns on instance of :attr:`SSLContext.sslsocket_class`
      instead of hard-coded :class:`SSLSocket`.

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1834)</p>
<p>Unknown directive type &quot;attribute&quot;.</p>
<pre class="literal-block">
.. attribute:: SSLContext.sslsocket_class

   The return type of :meth:`SSLContext.wrap_socket`, defaults to
   :class:`SSLSocket`. The attribute can be overridden on instance of class
   in order to return a custom subclass of :class:`SSLSocket`.

   .. versionadded:: 3.7

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1842)</p>
<p>Unknown directive type &quot;method&quot;.</p>
<pre class="literal-block">
.. method:: SSLContext.wrap_bio(incoming, outgoing, server_side=False, \
                                server_hostname=None, session=None)

   Wrap the BIO objects *incoming* and *outgoing* and return an instance of
   :attr:`SSLContext.sslobject_class` (default :class:`SSLObject`). The SSL
   routines will read input data from the incoming BIO and write data to the
   outgoing BIO.

   The *server_side*, *server_hostname* and *session* parameters have the
   same meaning as in :meth:`SSLContext.wrap_socket`.

   .. versionchanged:: 3.6
      *session* argument was added.

   .. versionchanged:: 3.7
      The method returns on instance of :attr:`SSLContext.sslobject_class`
      instead of hard-coded :class:`SSLObject`.

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1860)</p>
<p>Unknown directive type &quot;attribute&quot;.</p>
<pre class="literal-block">
.. attribute:: SSLContext.sslobject_class

   The return type of :meth:`SSLContext.wrap_bio`, defaults to
   :class:`SSLObject`. The attribute can be overridden on instance of class
   in order to return a custom subclass of :class:`SSLObject`.

   .. versionadded:: 3.7

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1868)</p>
<p>Unknown directive type &quot;method&quot;.</p>
<pre class="literal-block">
.. method:: SSLContext.session_stats()

   Get statistics about the SSL sessions created or managed by this context.
   A dictionary is returned which maps the names of each `piece of information &lt;https://www.openssl.org/docs/man1.1.0/ssl/SSL_CTX_sess_number.html&gt;`_ to their
   numeric values.  For example, here is the total number of hits and misses
   in the session cache since the context was created::

      &gt;&gt;&gt; stats = context.session_stats()
      &gt;&gt;&gt; stats['hits'], stats['misses']
      (0, 0)

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1879)</p>
<p>Unknown directive type &quot;attribute&quot;.</p>
<pre class="literal-block">
.. attribute:: SSLContext.check_hostname

   Whether to match the peer cert's hostname in
   :meth:`SSLSocket.do_handshake`. The context's
   :attr:`~SSLContext.verify_mode` must be set to :data:`CERT_OPTIONAL` or
   :data:`CERT_REQUIRED`, and you must pass *server_hostname* to
   :meth:`~SSLContext.wrap_socket` in order to match the hostname.  Enabling
   hostname checking automatically sets :attr:`~SSLContext.verify_mode` from
   :data:`CERT_NONE` to :data:`CERT_REQUIRED`.  It cannot be set back to
   :data:`CERT_NONE` as long as hostname checking is enabled. The
   :data:`PROTOCOL_TLS_CLIENT` protocol enables hostname checking by default.
   With other protocols, hostname checking must be enabled explicitly.

   Example::

      import socket, ssl

      context = ssl.SSLContext(ssl.PROTOCOL_TLSv1_2)
      context.verify_mode = ssl.CERT_REQUIRED
      context.check_hostname = True
      context.load_default_certs()

      s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
      ssl_sock = context.wrap_socket(s, server_hostname='www.verisign.com')
      ssl_sock.connect(('www.verisign.com', 443))

   .. versionadded:: 3.4

   .. versionchanged:: 3.7

      :attr:`~SSLContext.verify_mode` is now automatically changed
      to :data:`CERT_REQUIRED`  when hostname checking is enabled and
      :attr:`~SSLContext.verify_mode` is :data:`CERT_NONE`. Previously
      the same operation would have failed with a :exc:`ValueError`.

   .. note::

     This features requires OpenSSL 0.9.8f or newer.

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1918)</p>
<p>Unknown directive type &quot;attribute&quot;.</p>
<pre class="literal-block">
.. attribute:: SSLContext.keylog_filename

   Write TLS keys to a keylog file, whenever key material is generated or
   received. The keylog file is designed for debugging purposes only. The
   file format is specified by NSS and used by many traffic analyzers such
   as Wireshark. The log file is opened in append-only mode. Writes are
   synchronized between threads, but not between processes.

   .. versionadded:: 3.8

   .. note::

     This features requires OpenSSL 1.1.1 or newer.

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1932)</p>
<p>Unknown directive type &quot;attribute&quot;.</p>
<pre class="literal-block">
.. attribute:: SSLContext.maximum_version

   A :class:`TLSVersion` enum member representing the highest supported
   TLS version. The value defaults to :attr:`TLSVersion.MAXIMUM_SUPPORTED`.
   The attribute is read-only for protocols other than :attr:`PROTOCOL_TLS`,
   :attr:`PROTOCOL_TLS_CLIENT`, and :attr:`PROTOCOL_TLS_SERVER`.

   The attributes :attr:`~SSLContext.maximum_version`,
   :attr:`~SSLContext.minimum_version` and
   :attr:`SSLContext.options` all affect the supported SSL
   and TLS versions of the context. The implementation does not prevent
   invalid combination. For example a context with
   :attr:`OP_NO_TLSv1_2` in :attr:`~SSLContext.options` and
   :attr:`~SSLContext.maximum_version` set to :attr:`TLSVersion.TLSv1_2`
   will not be able to establish a TLS 1.2 connection.

   .. note::

     This attribute is not available unless the ssl module is compiled
     with OpenSSL 1.1.0g or newer.

   .. versionadded:: 3.7

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1955)</p>
<p>Unknown directive type &quot;attribute&quot;.</p>
<pre class="literal-block">
.. attribute:: SSLContext.minimum_version

   Like :attr:`SSLContext.maximum_version` except it is the lowest
   supported version or :attr:`TLSVersion.MINIMUM_SUPPORTED`.

   .. note::

     This attribute is not available unless the ssl module is compiled
     with OpenSSL 1.1.0g or newer.

   .. versionadded:: 3.7

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1967)</p>
<p>Unknown directive type &quot;attribute&quot;.</p>
<pre class="literal-block">
.. attribute:: SSLContext.num_tickets

   Control the number of TLS 1.3 session tickets of a
   :attr:`TLS_PROTOCOL_SERVER` context. The setting has no impact on TLS
   1.0 to 1.2 connections.

   .. note::

     This attribute is not available unless the ssl module is compiled
     with OpenSSL 1.1.1 or newer.

   .. versionadded:: 3.8

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1980)</p>
<p>Unknown directive type &quot;attribute&quot;.</p>
<pre class="literal-block">
.. attribute:: SSLContext.options

   An integer representing the set of SSL options enabled on this context.
   The default value is :data:`OP_ALL`, but you can specify other options
   such as :data:`OP_NO_SSLv2` by ORing them together.

   .. note::
      With versions of OpenSSL older than 0.9.8m, it is only possible
      to set options, not to clear them.  Attempting to clear an option
      (by resetting the corresponding bits) will raise a :exc:`ValueError`.

   .. versionchanged:: 3.6
      :attr:`SSLContext.options` returns :class:`Options` flags:

         &gt;&gt;&gt; ssl.create_default_context().options  # doctest: +SKIP
         &lt;Options.OP_ALL|OP_NO_SSLv3|OP_NO_SSLv2|OP_NO_COMPRESSION: 2197947391&gt;

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 1997)</p>
<p>Unknown directive type &quot;attribute&quot;.</p>
<pre class="literal-block">
.. attribute:: SSLContext.post_handshake_auth

   Enable TLS 1.3 post-handshake client authentication. Post-handshake auth
   is disabled by default and a server can only request a TLS client
   certificate during the initial handshake. When enabled, a server may
   request a TLS client certificate at any time after the handshake.

   When enabled on client-side sockets, the client signals the server that
   it supports post-handshake authentication.

   When enabled on server-side sockets, :attr:`SSLContext.verify_mode` must
   be set to :data:`CERT_OPTIONAL` or :data:`CERT_REQUIRED`, too. The
   actual client cert exchange is delayed until
   :meth:`SSLSocket.verify_client_post_handshake` is called and some I/O is
   performed.

   .. note::
      Only available with OpenSSL 1.1.1 and TLS 1.3 enabled. Without TLS 1.3
      support, the property value is None and can't be modified

   .. versionadded:: 3.8

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2019)</p>
<p>Unknown directive type &quot;attribute&quot;.</p>
<pre class="literal-block">
.. attribute:: SSLContext.protocol

   The protocol version chosen when constructing the context.  This attribute
   is read-only.

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2024)</p>
<p>Unknown directive type &quot;attribute&quot;.</p>
<pre class="literal-block">
.. attribute:: SSLContext.hostname_checks_common_name

   Whether :attr:`~SSLContext.check_hostname` falls back to verify the cert's
   subject common name in the absence of a subject alternative name
   extension (default: true).

   .. note::
      Only writeable with OpenSSL 1.1.0 or higher.

   .. versionadded:: 3.7

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2035)</p>
<p>Unknown directive type &quot;attribute&quot;.</p>
<pre class="literal-block">
.. attribute:: SSLContext.verify_flags

   The flags for certificate verification operations. You can set flags like
   :data:`VERIFY_CRL_CHECK_LEAF` by ORing them together. By default OpenSSL
   does neither require nor verify certificate revocation lists (CRLs).
   Available only with openssl version 0.9.8+.

   .. versionadded:: 3.4

   .. versionchanged:: 3.6
      :attr:`SSLContext.verify_flags` returns :class:`VerifyFlags` flags:

         &gt;&gt;&gt; ssl.create_default_context().verify_flags  # doctest: +SKIP
         &lt;VerifyFlags.VERIFY_X509_TRUSTED_FIRST: 32768&gt;

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2050)</p>
<p>Unknown directive type &quot;attribute&quot;.</p>
<pre class="literal-block">
.. attribute:: SSLContext.verify_mode

   Whether to try to verify other peers' certificates and how to behave
   if verification fails.  This attribute must be one of
   :data:`CERT_NONE`, :data:`CERT_OPTIONAL` or :data:`CERT_REQUIRED`.

   .. versionchanged:: 3.6
      :attr:`SSLContext.verify_mode` returns :class:`VerifyMode` enum:

         &gt;&gt;&gt; ssl.create_default_context().verify_mode
         &lt;VerifyMode.CERT_REQUIRED: 2&gt;

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2062)</p>
<p>Unknown directive type &quot;index&quot;.</p>
<pre class="literal-block">
.. index:: single: certificates

</pre>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2064)</p>
<p>Unknown directive type &quot;index&quot;.</p>
<pre class="literal-block">
.. index:: single: X509 certificate

</pre>
</div>
</div>
<div class="section" id="certificates">
<span id="ssl-certificates"></span><h1>Certificates</h1>
<p>Certificates in general are part of a public-key / private-key system.  In this
system, each <em>principal</em>, (which may be a machine, or a person, or an
organization) is assigned a unique two-part encryption key.  One part of the key
is public, and is called the <em>public key</em>; the other part is kept secret, and is
called the <em>private key</em>.  The two parts are related, in that if you encrypt a
message with one of the parts, you can decrypt it with the other part, and
<strong>only</strong> with the other part.</p>
<p>A certificate contains information about two principals.  It contains the name
of a <em>subject</em>, and the subject's public key.  It also contains a statement by a
second principal, the <em>issuer</em>, that the subject is who they claim to be, and
that this is indeed the subject's public key.  The issuer's statement is signed
with the issuer's private key, which only the issuer knows.  However, anyone can
verify the issuer's statement by finding the issuer's public key, decrypting the
statement with it, and comparing it to the other information in the certificate.
The certificate also contains information about the time period over which it is
valid.  This is expressed as two fields, called &quot;notBefore&quot; and &quot;notAfter&quot;.</p>
<p>In the Python use of certificates, a client or server can use a certificate to
prove who they are.  The other side of a network connection can also be required
to produce a certificate, and that certificate can be validated to the
satisfaction of the client or server that requires such validation.  The
connection attempt can be set to raise an exception if the validation fails.
Validation is done automatically, by the underlying OpenSSL framework; the
application need not concern itself with its mechanics.  But the application
does usually need to provide sets of certificates to allow this process to take
place.</p>
<p>Python uses files to contain certificates.  They should be formatted as &quot;PEM&quot;
(see <a class="reference external" href="http://tools.ietf.org/html/rfc1422.html">RFC 1422</a>), which is a base-64 encoded form wrapped with a header line
and a footer line:</p>
<pre class="literal-block">
-----BEGIN CERTIFICATE-----
... (certificate in base64 PEM encoding) ...
-----END CERTIFICATE-----
</pre>
<div class="section" id="certificate-chains">
<h2>Certificate chains</h2>
<p>The Python files which contain certificates can contain a sequence of
certificates, sometimes called a <em>certificate chain</em>.  This chain should start
with the specific certificate for the principal who &quot;is&quot; the client or server,
and then the certificate for the issuer of that certificate, and then the
certificate for the issuer of <em>that</em> certificate, and so on up the chain till
you get to a certificate which is <em>self-signed</em>, that is, a certificate which
has the same subject and issuer, sometimes called a <em>root certificate</em>.  The
certificates should just be concatenated together in the certificate file.  For
example, suppose we had a three certificate chain, from our server certificate
to the certificate of the certification authority that signed our server
certificate, to the root certificate of the agency which issued the
certification authority's certificate:</p>
<pre class="literal-block">
-----BEGIN CERTIFICATE-----
... (certificate for your server)...
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
... (the certificate for the CA)...
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
... (the root certificate for the CA's issuer)...
-----END CERTIFICATE-----
</pre>
</div>
<div class="section" id="ca-certificates">
<h2>CA certificates</h2>
<p>If you are going to require validation of the other side of the connection's
certificate, you need to provide a &quot;CA certs&quot; file, filled with the certificate
chains for each issuer you are willing to trust.  Again, this file just contains
these chains concatenated together.  For validation, Python will use the first
chain it finds in the file which matches.  The platform's certificates file can
be used by calling <a href="#id138"><span class="problematic" id="id139">:meth:`SSLContext.load_default_certs`</span></a>, this is done
automatically with <a href="#id140"><span class="problematic" id="id141">:func:`.create_default_context`</span></a>.</p>
<div class="system-message" id="id138">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2136); <em><a href="#id139">backlink</a></em></p>
Unknown interpreted text role &quot;meth&quot;.</div>
<div class="system-message" id="id140">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2136); <em><a href="#id141">backlink</a></em></p>
Unknown interpreted text role &quot;func&quot;.</div>
</div>
<div class="section" id="combined-key-and-certificate">
<h2>Combined key and certificate</h2>
<p>Often the private key is stored in the same file as the certificate; in this
case, only the <tt class="docutils literal">certfile</tt> parameter to <a href="#id142"><span class="problematic" id="id143">:meth:`SSLContext.load_cert_chain`</span></a>
and <a href="#id144"><span class="problematic" id="id145">:func:`wrap_socket`</span></a> needs to be passed.  If the private key is stored
with the certificate, it should come before the first certificate in
the certificate chain:</p>
<div class="system-message" id="id142">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2147); <em><a href="#id143">backlink</a></em></p>
Unknown interpreted text role &quot;meth&quot;.</div>
<div class="system-message" id="id144">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2147); <em><a href="#id145">backlink</a></em></p>
Unknown interpreted text role &quot;func&quot;.</div>
<pre class="literal-block">
-----BEGIN RSA PRIVATE KEY-----
... (private key in base64 encoding) ...
-----END RSA PRIVATE KEY-----
-----BEGIN CERTIFICATE-----
... (certificate in base64 PEM encoding) ...
-----END CERTIFICATE-----
</pre>
</div>
<div class="section" id="self-signed-certificates">
<h2>Self-signed certificates</h2>
<p>If you are going to create a server that provides SSL-encrypted connection
services, you will need to acquire a certificate for that service.  There are
many ways of acquiring appropriate certificates, such as buying one from a
certification authority.  Another common practice is to generate a self-signed
certificate.  The simplest way to do this is with the OpenSSL package, using
something like the following:</p>
<pre class="literal-block">
% openssl req -new -x509 -days 365 -nodes -out cert.pem -keyout cert.pem
Generating a 1024 bit RSA private key
.......++++++
.............................++++++
writing new private key to 'cert.pem'
-----
You are about to be asked to enter information that will be incorporated
into your certificate request.
What you are about to enter is what is called a Distinguished Name or a DN.
There are quite a few fields but you can leave some blank
For some fields there will be a default value,
If you enter '.', the field will be left blank.
-----
Country Name (2 letter code) [AU]:US
State or Province Name (full name) [Some-State]:MyState
Locality Name (eg, city) []:Some City
Organization Name (eg, company) [Internet Widgits Pty Ltd]:My Organization, Inc.
Organizational Unit Name (eg, section) []:My Group
Common Name (eg, YOUR name) []:myserver.mygroup.myorganization.com
Email Address []:ops&#64;myserver.mygroup.myorganization.com
%
</pre>
<p>The disadvantage of a self-signed certificate is that it is its own root
certificate, and no one else will have it in their cache of known (and trusted)
root certificates.</p>
</div>
</div>
<div class="section" id="examples">
<h1>Examples</h1>
<div class="section" id="testing-for-ssl-support">
<h2>Testing for SSL support</h2>
<p>To test for the presence of SSL support in a Python installation, user code
should use the following idiom:</p>
<pre class="literal-block">
try:
    import ssl
except ImportError:
    pass
else:
    ...  # do something that requires SSL support
</pre>
</div>
<div class="section" id="client-side-operation">
<h2>Client-side operation</h2>
<p>This example creates a SSL context with the recommended security settings
for client sockets, including automatic certificate verification:</p>
<pre class="literal-block">
&gt;&gt;&gt; context = ssl.create_default_context()
</pre>
<p>If you prefer to tune security settings yourself, you might create
a context from scratch (but beware that you might not get the settings
right):</p>
<pre class="literal-block">
&gt;&gt;&gt; context = ssl.SSLContext(ssl.PROTOCOL_TLS_CLIENT)
&gt;&gt;&gt; context.load_verify_locations(&quot;/etc/ssl/certs/ca-bundle.crt&quot;)
</pre>
<p>(this snippet assumes your operating system places a bundle of all CA
certificates in <tt class="docutils literal"><span class="pre">/etc/ssl/certs/ca-bundle.crt</span></tt>; if not, you'll get an
error and have to adjust the location)</p>
<p>The <a href="#id146"><span class="problematic" id="id147">:data:`PROTOCOL_TLS_CLIENT`</span></a> protocol configures the context for cert
validation and hostname verification. <a href="#id148"><span class="problematic" id="id149">:attr:`~SSLContext.verify_mode`</span></a> is
set to <a href="#id150"><span class="problematic" id="id151">:data:`CERT_REQUIRED`</span></a> and <a href="#id152"><span class="problematic" id="id153">:attr:`~SSLContext.check_hostname`</span></a> is set
to <tt class="docutils literal">True</tt>. All other protocols create SSL contexts with insecure defaults.</p>
<div class="system-message" id="id146">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2232); <em><a href="#id147">backlink</a></em></p>
Unknown interpreted text role &quot;data&quot;.</div>
<div class="system-message" id="id148">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2232); <em><a href="#id149">backlink</a></em></p>
Unknown interpreted text role &quot;attr&quot;.</div>
<div class="system-message" id="id150">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2232); <em><a href="#id151">backlink</a></em></p>
Unknown interpreted text role &quot;data&quot;.</div>
<div class="system-message" id="id152">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2232); <em><a href="#id153">backlink</a></em></p>
Unknown interpreted text role &quot;attr&quot;.</div>
<p>When you use the context to connect to a server, <a href="#id154"><span class="problematic" id="id155">:const:`CERT_REQUIRED`</span></a>
and <a href="#id156"><span class="problematic" id="id157">:attr:`~SSLContext.check_hostname`</span></a> validate the server certificate: it
ensures that the server certificate was signed with one of the CA
certificates, checks the signature for correctness, and verifies other
properties like validity and identity of the hostname:</p>
<div class="system-message" id="id154">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2237); <em><a href="#id155">backlink</a></em></p>
Unknown interpreted text role &quot;const&quot;.</div>
<div class="system-message" id="id156">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2237); <em><a href="#id157">backlink</a></em></p>
Unknown interpreted text role &quot;attr&quot;.</div>
<pre class="literal-block">
&gt;&gt;&gt; conn = context.wrap_socket(socket.socket(socket.AF_INET),
...                            server_hostname=&quot;www.python.org&quot;)
&gt;&gt;&gt; conn.connect((&quot;www.python.org&quot;, 443))
</pre>
<p>You may then fetch the certificate:</p>
<pre class="literal-block">
&gt;&gt;&gt; cert = conn.getpeercert()
</pre>
<p>Visual inspection shows that the certificate does identify the desired service
(that is, the HTTPS host <tt class="docutils literal">www.python.org</tt>):</p>
<pre class="literal-block">
&gt;&gt;&gt; pprint.pprint(cert)
{'OCSP': ('http://ocsp.digicert.com',),
 'caIssuers': ('http://cacerts.digicert.com/DigiCertSHA2ExtendedValidationServerCA.crt',),
 'crlDistributionPoints': ('http://crl3.digicert.com/sha2-ev-server-g1.crl',
                           'http://crl4.digicert.com/sha2-ev-server-g1.crl'),
 'issuer': ((('countryName', 'US'),),
            (('organizationName', 'DigiCert Inc'),),
            (('organizationalUnitName', 'www.digicert.com'),),
            (('commonName', 'DigiCert SHA2 Extended Validation Server CA'),)),
 'notAfter': 'Sep  9 12:00:00 2016 GMT',
 'notBefore': 'Sep  5 00:00:00 2014 GMT',
 'serialNumber': '01BB6F00122B177F36CAB49CEA8B6B26',
 'subject': ((('businessCategory', 'Private Organization'),),
             (('1.3.6.1.4.1.311.60.2.1.3', 'US'),),
             (('1.3.6.1.4.1.311.60.2.1.2', 'Delaware'),),
             (('serialNumber', '3359300'),),
             (('streetAddress', '16 Allen Rd'),),
             (('postalCode', '03894-4801'),),
             (('countryName', 'US'),),
             (('stateOrProvinceName', 'NH'),),
             (('localityName', 'Wolfeboro'),),
             (('organizationName', 'Python Software Foundation'),),
             (('commonName', 'www.python.org'),)),
 'subjectAltName': (('DNS', 'www.python.org'),
                    ('DNS', 'python.org'),
                    ('DNS', 'pypi.org'),
                    ('DNS', 'docs.python.org'),
                    ('DNS', 'testpypi.org'),
                    ('DNS', 'bugs.python.org'),
                    ('DNS', 'wiki.python.org'),
                    ('DNS', 'hg.python.org'),
                    ('DNS', 'mail.python.org'),
                    ('DNS', 'packaging.python.org'),
                    ('DNS', 'pythonhosted.org'),
                    ('DNS', 'www.pythonhosted.org'),
                    ('DNS', 'test.pythonhosted.org'),
                    ('DNS', 'us.pycon.org'),
                    ('DNS', 'id.python.org')),
 'version': 3}
</pre>
<p>Now the SSL channel is established and the certificate verified, you can
proceed to talk with the server:</p>
<pre class="literal-block">
&gt;&gt;&gt; conn.sendall(b&quot;HEAD / HTTP/1.0\r\nHost: linuxfr.org\r\n\r\n&quot;)
&gt;&gt;&gt; pprint.pprint(conn.recv(1024).split(b&quot;\r\n&quot;))
[b'HTTP/1.1 200 OK',
 b'Date: Sat, 18 Oct 2014 18:27:20 GMT',
 b'Server: nginx',
 b'Content-Type: text/html; charset=utf-8',
 b'X-Frame-Options: SAMEORIGIN',
 b'Content-Length: 45679',
 b'Accept-Ranges: bytes',
 b'Via: 1.1 varnish',
 b'Age: 2188',
 b'X-Served-By: cache-lcy1134-LCY',
 b'X-Cache: HIT',
 b'X-Cache-Hits: 11',
 b'Vary: Cookie',
 b'Strict-Transport-Security: max-age=63072000; includeSubDomains',
 b'Connection: close',
 b'',
 b'']
</pre>
<p>See the discussion of <a href="#id158"><span class="problematic" id="id159">:ref:`ssl-security`</span></a> below.</p>
<div class="system-message" id="id158">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2317); <em><a href="#id159">backlink</a></em></p>
Unknown interpreted text role &quot;ref&quot;.</div>
</div>
<div class="section" id="server-side-operation">
<h2>Server-side operation</h2>
<p>For server operation, typically you'll need to have a server certificate, and
private key, each in a file.  You'll first create a context holding the key
and the certificate, so that clients can check your authenticity.  Then
you'll open a socket, bind it to a port, call <a href="#id160"><span class="problematic" id="id161">:meth:`listen`</span></a> on it, and start
waiting for clients to connect:</p>
<div class="system-message" id="id160">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2323); <em><a href="#id161">backlink</a></em></p>
Unknown interpreted text role &quot;meth&quot;.</div>
<pre class="literal-block">
import socket, ssl

context = ssl.create_default_context(ssl.Purpose.CLIENT_AUTH)
context.load_cert_chain(certfile=&quot;mycertfile&quot;, keyfile=&quot;mykeyfile&quot;)

bindsocket = socket.socket()
bindsocket.bind(('myaddr.mydomain.com', 10023))
bindsocket.listen(5)
</pre>
<p>When a client connects, you'll call <a href="#id162"><span class="problematic" id="id163">:meth:`accept`</span></a> on the socket to get the
new socket from the other end, and use the context's <a href="#id164"><span class="problematic" id="id165">:meth:`SSLContext.wrap_socket`</span></a>
method to create a server-side SSL socket for the connection:</p>
<div class="system-message" id="id162">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2338); <em><a href="#id163">backlink</a></em></p>
Unknown interpreted text role &quot;meth&quot;.</div>
<div class="system-message" id="id164">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2338); <em><a href="#id165">backlink</a></em></p>
Unknown interpreted text role &quot;meth&quot;.</div>
<pre class="literal-block">
while True:
    newsocket, fromaddr = bindsocket.accept()
    connstream = context.wrap_socket(newsocket, server_side=True)
    try:
        deal_with_client(connstream)
    finally:
        connstream.shutdown(socket.SHUT_RDWR)
        connstream.close()
</pre>
<p>Then you'll read data from the <tt class="docutils literal">connstream</tt> and do something with it till you
are finished with the client (or the client is finished with you):</p>
<pre class="literal-block">
def deal_with_client(connstream):
    data = connstream.recv(1024)
    # empty data means the client is finished with us
    while data:
        if not do_something(connstream, data):
            # we'll assume do_something returns False
            # when we're finished with client
            break
        data = connstream.recv(1024)
    # finished with client
</pre>
<p>And go back to listening for new client connections (of course, a real server
would probably handle each client connection in a separate thread, or put
the sockets in <a href="#id166"><span class="problematic" id="id167">:ref:`non-blocking mode &lt;ssl-nonblocking&gt;`</span></a> and use an event loop).</p>
<div class="system-message" id="id166">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2365); <em><a href="#id167">backlink</a></em></p>
Unknown interpreted text role &quot;ref&quot;.</div>
</div>
</div>
<div class="section" id="notes-on-non-blocking-sockets">
<span id="ssl-nonblocking"></span><h1>Notes on non-blocking sockets</h1>
<p>SSL sockets behave slightly different than regular sockets in
non-blocking mode. When working with non-blocking sockets, there are
thus several things you need to be aware of:</p>
<ul>
<li><p class="first">Most <a href="#id168"><span class="problematic" id="id169">:class:`SSLSocket`</span></a> methods will raise either
<a href="#id170"><span class="problematic" id="id171">:exc:`SSLWantWriteError`</span></a> or <a href="#id172"><span class="problematic" id="id173">:exc:`SSLWantReadError`</span></a> instead of
<a href="#id174"><span class="problematic" id="id175">:exc:`BlockingIOError`</span></a> if an I/O operation would
block. <a href="#id176"><span class="problematic" id="id177">:exc:`SSLWantReadError`</span></a> will be raised if a read operation on
the underlying socket is necessary, and <a href="#id178"><span class="problematic" id="id179">:exc:`SSLWantWriteError`</span></a> for
a write operation on the underlying socket. Note that attempts to
<em>write</em> to an SSL socket may require <em>reading</em> from the underlying
socket first, and attempts to <em>read</em> from the SSL socket may require
a prior <em>write</em> to the underlying socket.</p>
<div class="system-message" id="id168">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2379); <em><a href="#id169">backlink</a></em></p>
<p>Unknown interpreted text role &quot;class&quot;.</p>
</div>
<div class="system-message" id="id170">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2379); <em><a href="#id171">backlink</a></em></p>
<p>Unknown interpreted text role &quot;exc&quot;.</p>
</div>
<div class="system-message" id="id172">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2379); <em><a href="#id173">backlink</a></em></p>
<p>Unknown interpreted text role &quot;exc&quot;.</p>
</div>
<div class="system-message" id="id174">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2379); <em><a href="#id175">backlink</a></em></p>
<p>Unknown interpreted text role &quot;exc&quot;.</p>
</div>
<div class="system-message" id="id176">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2379); <em><a href="#id177">backlink</a></em></p>
<p>Unknown interpreted text role &quot;exc&quot;.</p>
</div>
<div class="system-message" id="id178">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2379); <em><a href="#id179">backlink</a></em></p>
<p>Unknown interpreted text role &quot;exc&quot;.</p>
</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2389)</p>
<p>Unknown directive type &quot;versionchanged&quot;.</p>
<pre class="literal-block">
.. versionchanged:: 3.5

   In earlier Python versions, the :meth:`!SSLSocket.send` method
   returned zero instead of raising :exc:`SSLWantWriteError` or
   :exc:`SSLWantReadError`.

</pre>
</div>
</li>
<li><p class="first">Calling <a href="#id180"><span class="problematic" id="id181">:func:`~select.select`</span></a> tells you that the OS-level socket can be
read from (or written to), but it does not imply that there is sufficient
data at the upper SSL layer.  For example, only part of an SSL frame might
have arrived.  Therefore, you must be ready to handle <a href="#id182"><span class="problematic" id="id183">:meth:`SSLSocket.recv`</span></a>
and <a href="#id184"><span class="problematic" id="id185">:meth:`SSLSocket.send`</span></a> failures, and retry after another call to
<a href="#id186"><span class="problematic" id="id187">:func:`~select.select`</span></a>.</p>
<div class="system-message" id="id180">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2395); <em><a href="#id181">backlink</a></em></p>
<p>Unknown interpreted text role &quot;func&quot;.</p>
</div>
<div class="system-message" id="id182">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2395); <em><a href="#id183">backlink</a></em></p>
<p>Unknown interpreted text role &quot;meth&quot;.</p>
</div>
<div class="system-message" id="id184">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2395); <em><a href="#id185">backlink</a></em></p>
<p>Unknown interpreted text role &quot;meth&quot;.</p>
</div>
<div class="system-message" id="id186">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2395); <em><a href="#id187">backlink</a></em></p>
<p>Unknown interpreted text role &quot;func&quot;.</p>
</div>
</li>
<li><p class="first">Conversely, since the SSL layer has its own framing, a SSL socket may
still have data available for reading without <a href="#id188"><span class="problematic" id="id189">:func:`~select.select`</span></a>
being aware of it.  Therefore, you should first call
<a href="#id190"><span class="problematic" id="id191">:meth:`SSLSocket.recv`</span></a> to drain any potentially available data, and then
only block on a <a href="#id192"><span class="problematic" id="id193">:func:`~select.select`</span></a> call if still necessary.</p>
<div class="system-message" id="id188">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2402); <em><a href="#id189">backlink</a></em></p>
<p>Unknown interpreted text role &quot;func&quot;.</p>
</div>
<div class="system-message" id="id190">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2402); <em><a href="#id191">backlink</a></em></p>
<p>Unknown interpreted text role &quot;meth&quot;.</p>
</div>
<div class="system-message" id="id192">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2402); <em><a href="#id193">backlink</a></em></p>
<p>Unknown interpreted text role &quot;func&quot;.</p>
</div>
<p>(of course, similar provisions apply when using other primitives such as
<a href="#id194"><span class="problematic" id="id195">:func:`~select.poll`</span></a>, or those in the <a href="#id196"><span class="problematic" id="id197">:mod:`selectors`</span></a> module)</p>
<div class="system-message" id="id194">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2408); <em><a href="#id195">backlink</a></em></p>
<p>Unknown interpreted text role &quot;func&quot;.</p>
</div>
<div class="system-message" id="id196">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2408); <em><a href="#id197">backlink</a></em></p>
<p>Unknown interpreted text role &quot;mod&quot;.</p>
</div>
</li>
<li><p class="first">The SSL handshake itself will be non-blocking: the
<a href="#id198"><span class="problematic" id="id199">:meth:`SSLSocket.do_handshake`</span></a> method has to be retried until it returns
successfully.  Here is a synopsis using <a href="#id200"><span class="problematic" id="id201">:func:`~select.select`</span></a> to wait for
the socket's readiness:</p>
<div class="system-message" id="id198">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2411); <em><a href="#id199">backlink</a></em></p>
<p>Unknown interpreted text role &quot;meth&quot;.</p>
</div>
<div class="system-message" id="id200">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2411); <em><a href="#id201">backlink</a></em></p>
<p>Unknown interpreted text role &quot;func&quot;.</p>
</div>
<pre class="literal-block">
while True:
    try:
        sock.do_handshake()
        break
    except ssl.SSLWantReadError:
        select.select([sock], [], [])
    except ssl.SSLWantWriteError:
        select.select([], [sock], [])
</pre>
</li>
</ul>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2425)</p>
<p>Unknown directive type &quot;seealso&quot;.</p>
<pre class="literal-block">
.. seealso::

   The :mod:`asyncio` module supports :ref:`non-blocking SSL sockets
   &lt;ssl-nonblocking&gt;` and provides a
   higher level API. It polls for events using the :mod:`selectors` module and
   handles :exc:`SSLWantWriteError`, :exc:`SSLWantReadError` and
   :exc:`BlockingIOError` exceptions. It runs the SSL handshake asynchronously
   as well.


</pre>
</div>
</div>
<div class="section" id="memory-bio-support">
<h1>Memory BIO Support</h1>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2438)</p>
<p>Unknown directive type &quot;versionadded&quot;.</p>
<pre class="literal-block">
.. versionadded:: 3.5

</pre>
</div>
<p>Ever since the SSL module was introduced in Python 2.6, the <a href="#id202"><span class="problematic" id="id203">:class:`SSLSocket`</span></a>
class has provided two related but distinct areas of functionality:</p>
<div class="system-message" id="id202">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2440); <em><a href="#id203">backlink</a></em></p>
Unknown interpreted text role &quot;class&quot;.</div>
<ul class="simple">
<li>SSL protocol handling</li>
<li>Network IO</li>
</ul>
<p>The network IO API is identical to that provided by <a href="#id204"><span class="problematic" id="id205">:class:`socket.socket`</span></a>,
from which <a href="#id206"><span class="problematic" id="id207">:class:`SSLSocket`</span></a> also inherits. This allows an SSL socket to be
used as a drop-in replacement for a regular socket, making it very easy to add
SSL support to an existing application.</p>
<div class="system-message" id="id204">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2446); <em><a href="#id205">backlink</a></em></p>
Unknown interpreted text role &quot;class&quot;.</div>
<div class="system-message" id="id206">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2446); <em><a href="#id207">backlink</a></em></p>
Unknown interpreted text role &quot;class&quot;.</div>
<p>Combining SSL protocol handling and network IO usually works well, but there
are some cases where it doesn't. An example is async IO frameworks that want to
use a different IO multiplexing model than the &quot;select/poll on a file
descriptor&quot; (readiness based) model that is assumed by <a href="#id208"><span class="problematic" id="id209">:class:`socket.socket`</span></a>
and by the internal OpenSSL socket IO routines. This is mostly relevant for
platforms like Windows where this model is not efficient. For this purpose, a
reduced scope variant of <a href="#id210"><span class="problematic" id="id211">:class:`SSLSocket`</span></a> called <a href="#id212"><span class="problematic" id="id213">:class:`SSLObject`</span></a> is
provided.</p>
<div class="system-message" id="id208">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2451); <em><a href="#id209">backlink</a></em></p>
Unknown interpreted text role &quot;class&quot;.</div>
<div class="system-message" id="id210">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2451); <em><a href="#id211">backlink</a></em></p>
Unknown interpreted text role &quot;class&quot;.</div>
<div class="system-message" id="id212">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2451); <em><a href="#id213">backlink</a></em></p>
Unknown interpreted text role &quot;class&quot;.</div>
<p class="sslobject">A reduced-scope variant of <a href="#id214"><span class="problematic" id="id215">:class:`SSLSocket`</span></a> representing an SSL protocol
instance that does not contain any network IO methods. This class is
typically used by framework authors that want to implement asynchronous IO
for SSL through memory buffers.</p>
<div class="sslobject system-message" id="id214">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2462); <em><a href="#id215">backlink</a></em></p>
Unknown interpreted text role &quot;class&quot;.</div>
<p class="sslobject">This class implements an interface on top of a low-level SSL object as
implemented by OpenSSL. This object captures the state of an SSL connection
but does not provide any network IO itself. IO needs to be performed through
separate &quot;BIO&quot; objects which are OpenSSL's IO abstraction layer.</p>
<p class="sslobject">This class has no public constructor.  An <a href="#id216"><span class="problematic" id="id217">:class:`SSLObject`</span></a> instance
must be created using the <a href="#id218"><span class="problematic" id="id219">:meth:`~SSLContext.wrap_bio`</span></a> method. This
method will create the <a href="#id220"><span class="problematic" id="id221">:class:`SSLObject`</span></a> instance and bind it to a
pair of BIOs. The <em>incoming</em> BIO is used to pass data from Python to the
SSL protocol instance, while the <em>outgoing</em> BIO is used to pass data the
other way around.</p>
<div class="sslobject system-message" id="id216">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2472); <em><a href="#id217">backlink</a></em></p>
Unknown interpreted text role &quot;class&quot;.</div>
<div class="sslobject system-message" id="id218">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2472); <em><a href="#id219">backlink</a></em></p>
Unknown interpreted text role &quot;meth&quot;.</div>
<div class="sslobject system-message" id="id220">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2472); <em><a href="#id221">backlink</a></em></p>
Unknown interpreted text role &quot;class&quot;.</div>
<p class="sslobject">The following methods are available:</p>
<ul class="sslobject">
<li><p class="first"><a href="#id222"><span class="problematic" id="id223">:attr:`~SSLSocket.context`</span></a></p>
<div class="system-message" id="id222">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2481); <em><a href="#id223">backlink</a></em></p>
<p>Unknown interpreted text role &quot;attr&quot;.</p>
</div>
</li>
<li><p class="first"><a href="#id224"><span class="problematic" id="id225">:attr:`~SSLSocket.server_side`</span></a></p>
<div class="system-message" id="id224">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2482); <em><a href="#id225">backlink</a></em></p>
<p>Unknown interpreted text role &quot;attr&quot;.</p>
</div>
</li>
<li><p class="first"><a href="#id226"><span class="problematic" id="id227">:attr:`~SSLSocket.server_hostname`</span></a></p>
<div class="system-message" id="id226">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2483); <em><a href="#id227">backlink</a></em></p>
<p>Unknown interpreted text role &quot;attr&quot;.</p>
</div>
</li>
<li><p class="first"><a href="#id228"><span class="problematic" id="id229">:attr:`~SSLSocket.session`</span></a></p>
<div class="system-message" id="id228">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2484); <em><a href="#id229">backlink</a></em></p>
<p>Unknown interpreted text role &quot;attr&quot;.</p>
</div>
</li>
<li><p class="first"><a href="#id230"><span class="problematic" id="id231">:attr:`~SSLSocket.session_reused`</span></a></p>
<div class="system-message" id="id230">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2485); <em><a href="#id231">backlink</a></em></p>
<p>Unknown interpreted text role &quot;attr&quot;.</p>
</div>
</li>
<li><p class="first"><a href="#id232"><span class="problematic" id="id233">:meth:`~SSLSocket.read`</span></a></p>
<div class="system-message" id="id232">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2486); <em><a href="#id233">backlink</a></em></p>
<p>Unknown interpreted text role &quot;meth&quot;.</p>
</div>
</li>
<li><p class="first"><a href="#id234"><span class="problematic" id="id235">:meth:`~SSLSocket.write`</span></a></p>
<div class="system-message" id="id234">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2487); <em><a href="#id235">backlink</a></em></p>
<p>Unknown interpreted text role &quot;meth&quot;.</p>
</div>
</li>
<li><p class="first"><a href="#id236"><span class="problematic" id="id237">:meth:`~SSLSocket.getpeercert`</span></a></p>
<div class="system-message" id="id236">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2488); <em><a href="#id237">backlink</a></em></p>
<p>Unknown interpreted text role &quot;meth&quot;.</p>
</div>
</li>
<li><p class="first"><a href="#id238"><span class="problematic" id="id239">:meth:`~SSLSocket.selected_alpn_protocol`</span></a></p>
<div class="system-message" id="id238">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2489); <em><a href="#id239">backlink</a></em></p>
<p>Unknown interpreted text role &quot;meth&quot;.</p>
</div>
</li>
<li><p class="first"><a href="#id240"><span class="problematic" id="id241">:meth:`~SSLSocket.selected_npn_protocol`</span></a></p>
<div class="system-message" id="id240">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2490); <em><a href="#id241">backlink</a></em></p>
<p>Unknown interpreted text role &quot;meth&quot;.</p>
</div>
</li>
<li><p class="first"><a href="#id242"><span class="problematic" id="id243">:meth:`~SSLSocket.cipher`</span></a></p>
<div class="system-message" id="id242">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2491); <em><a href="#id243">backlink</a></em></p>
<p>Unknown interpreted text role &quot;meth&quot;.</p>
</div>
</li>
<li><p class="first"><a href="#id244"><span class="problematic" id="id245">:meth:`~SSLSocket.shared_ciphers`</span></a></p>
<div class="system-message" id="id244">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2492); <em><a href="#id245">backlink</a></em></p>
<p>Unknown interpreted text role &quot;meth&quot;.</p>
</div>
</li>
<li><p class="first"><a href="#id246"><span class="problematic" id="id247">:meth:`~SSLSocket.compression`</span></a></p>
<div class="system-message" id="id246">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2493); <em><a href="#id247">backlink</a></em></p>
<p>Unknown interpreted text role &quot;meth&quot;.</p>
</div>
</li>
<li><p class="first"><a href="#id248"><span class="problematic" id="id249">:meth:`~SSLSocket.pending`</span></a></p>
<div class="system-message" id="id248">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2494); <em><a href="#id249">backlink</a></em></p>
<p>Unknown interpreted text role &quot;meth&quot;.</p>
</div>
</li>
<li><p class="first"><a href="#id250"><span class="problematic" id="id251">:meth:`~SSLSocket.do_handshake`</span></a></p>
<div class="system-message" id="id250">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2495); <em><a href="#id251">backlink</a></em></p>
<p>Unknown interpreted text role &quot;meth&quot;.</p>
</div>
</li>
<li><p class="first"><a href="#id252"><span class="problematic" id="id253">:meth:`~SSLSocket.verify_client_post_handshake`</span></a></p>
<div class="system-message" id="id252">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2496); <em><a href="#id253">backlink</a></em></p>
<p>Unknown interpreted text role &quot;meth&quot;.</p>
</div>
</li>
<li><p class="first"><a href="#id254"><span class="problematic" id="id255">:meth:`~SSLSocket.unwrap`</span></a></p>
<div class="system-message" id="id254">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2497); <em><a href="#id255">backlink</a></em></p>
<p>Unknown interpreted text role &quot;meth&quot;.</p>
</div>
</li>
<li><p class="first"><a href="#id256"><span class="problematic" id="id257">:meth:`~SSLSocket.get_channel_binding`</span></a></p>
<div class="system-message" id="id256">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2498); <em><a href="#id257">backlink</a></em></p>
<p>Unknown interpreted text role &quot;meth&quot;.</p>
</div>
</li>
<li><p class="first"><a href="#id258"><span class="problematic" id="id259">:meth:`~SSLSocket.version`</span></a></p>
<div class="system-message" id="id258">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2499); <em><a href="#id259">backlink</a></em></p>
<p>Unknown interpreted text role &quot;meth&quot;.</p>
</div>
</li>
</ul>
<p class="sslobject">When compared to <a href="#id260"><span class="problematic" id="id261">:class:`SSLSocket`</span></a>, this object lacks the following
features:</p>
<div class="sslobject system-message" id="id260">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2501); <em><a href="#id261">backlink</a></em></p>
Unknown interpreted text role &quot;class&quot;.</div>
<ul class="sslobject">
<li><p class="first">Any form of network IO; <tt class="docutils literal">recv()</tt> and <tt class="docutils literal">send()</tt> read and write only to
the underlying <a href="#id262"><span class="problematic" id="id263">:class:`MemoryBIO`</span></a> buffers.</p>
<div class="system-message" id="id262">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2504); <em><a href="#id263">backlink</a></em></p>
<p>Unknown interpreted text role &quot;class&quot;.</p>
</div>
</li>
<li><p class="first">There is no <em>do_handshake_on_connect</em> machinery. You must always manually
call <a href="#id264"><span class="problematic" id="id265">:meth:`~SSLSocket.do_handshake`</span></a> to start the handshake.</p>
<div class="system-message" id="id264">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2507); <em><a href="#id265">backlink</a></em></p>
<p>Unknown interpreted text role &quot;meth&quot;.</p>
</div>
</li>
<li><p class="first">There is no handling of <em>suppress_ragged_eofs</em>. All end-of-file conditions
that are in violation of the protocol are reported via the
<a href="#id266"><span class="problematic" id="id267">:exc:`SSLEOFError`</span></a> exception.</p>
<div class="system-message" id="id266">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2510); <em><a href="#id267">backlink</a></em></p>
<p>Unknown interpreted text role &quot;exc&quot;.</p>
</div>
</li>
<li><p class="first">The method <a href="#id268"><span class="problematic" id="id269">:meth:`~SSLSocket.unwrap`</span></a> call does not return anything,
unlike for an SSL socket where it returns the underlying socket.</p>
<div class="system-message" id="id268">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2514); <em><a href="#id269">backlink</a></em></p>
<p>Unknown interpreted text role &quot;meth&quot;.</p>
</div>
</li>
<li><p class="first">The <em>server_name_callback</em> callback passed to
<a href="#id270"><span class="problematic" id="id271">:meth:`SSLContext.set_servername_callback`</span></a> will get an <a href="#id272"><span class="problematic" id="id273">:class:`SSLObject`</span></a>
instance instead of a <a href="#id274"><span class="problematic" id="id275">:class:`SSLSocket`</span></a> instance as its first parameter.</p>
<div class="system-message" id="id270">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2517); <em><a href="#id271">backlink</a></em></p>
<p>Unknown interpreted text role &quot;meth&quot;.</p>
</div>
<div class="system-message" id="id272">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2517); <em><a href="#id273">backlink</a></em></p>
<p>Unknown interpreted text role &quot;class&quot;.</p>
</div>
<div class="system-message" id="id274">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2517); <em><a href="#id275">backlink</a></em></p>
<p>Unknown interpreted text role &quot;class&quot;.</p>
</div>
</li>
</ul>
<p class="sslobject">Some notes related to the use of <a href="#id276"><span class="problematic" id="id277">:class:`SSLObject`</span></a>:</p>
<div class="sslobject system-message" id="id276">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2521); <em><a href="#id277">backlink</a></em></p>
Unknown interpreted text role &quot;class&quot;.</div>
<ul class="sslobject">
<li><p class="first">All IO on an <a href="#id278"><span class="problematic" id="id279">:class:`SSLObject`</span></a> is <a href="#id280"><span class="problematic" id="id281">:ref:`non-blocking &lt;ssl-nonblocking&gt;`</span></a>.
This means that for example <a href="#id282"><span class="problematic" id="id283">:meth:`~SSLSocket.read`</span></a> will raise an
<a href="#id284"><span class="problematic" id="id285">:exc:`SSLWantReadError`</span></a> if it needs more data than the incoming BIO has
available.</p>
<div class="system-message" id="id278">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2523); <em><a href="#id279">backlink</a></em></p>
<p>Unknown interpreted text role &quot;class&quot;.</p>
</div>
<div class="system-message" id="id280">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2523); <em><a href="#id281">backlink</a></em></p>
<p>Unknown interpreted text role &quot;ref&quot;.</p>
</div>
<div class="system-message" id="id282">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2523); <em><a href="#id283">backlink</a></em></p>
<p>Unknown interpreted text role &quot;meth&quot;.</p>
</div>
<div class="system-message" id="id284">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2523); <em><a href="#id285">backlink</a></em></p>
<p>Unknown interpreted text role &quot;exc&quot;.</p>
</div>
</li>
<li><p class="first">There is no module-level <tt class="docutils literal">wrap_bio()</tt> call like there is for
<a href="#id286"><span class="problematic" id="id287">:meth:`~SSLContext.wrap_socket`</span></a>. An <a href="#id288"><span class="problematic" id="id289">:class:`SSLObject`</span></a> is always created
via an <a href="#id290"><span class="problematic" id="id291">:class:`SSLContext`</span></a>.</p>
<div class="system-message" id="id286">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2528); <em><a href="#id287">backlink</a></em></p>
<p>Unknown interpreted text role &quot;meth&quot;.</p>
</div>
<div class="system-message" id="id288">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2528); <em><a href="#id289">backlink</a></em></p>
<p>Unknown interpreted text role &quot;class&quot;.</p>
</div>
<div class="system-message" id="id290">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2528); <em><a href="#id291">backlink</a></em></p>
<p>Unknown interpreted text role &quot;class&quot;.</p>
</div>
</li>
</ul>
<div class="sslobject system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2532)</p>
<p>Unknown directive type &quot;versionchanged&quot;.</p>
<pre class="literal-block">
.. versionchanged:: 3.7
   :class:`SSLObject` instances must to created with
   :meth:`~SSLContext.wrap_bio`. In earlier versions, it was possible to
   create instances directly. This was never documented or officially
   supported.
</pre>
</div>
<p>An SSLObject communicates with the outside world using memory buffers. The
class <a href="#id292"><span class="problematic" id="id293">:class:`MemoryBIO`</span></a> provides a memory buffer that can be used for this
purpose.  It wraps an OpenSSL memory BIO (Basic IO) object:</p>
<div class="system-message" id="id292">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2538); <em><a href="#id293">backlink</a></em></p>
Unknown interpreted text role &quot;class&quot;.</div>
<p class="memorybio">A memory buffer that can be used to pass data between Python and an SSL
protocol instance.</p>
<div class="memorybio system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2547)</p>
<p>Unknown directive type &quot;attribute&quot;.</p>
<pre class="literal-block">
.. attribute:: MemoryBIO.pending

   Return the number of bytes currently in the memory buffer.

</pre>
</div>
<div class="memorybio system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2551)</p>
<p>Unknown directive type &quot;attribute&quot;.</p>
<pre class="literal-block">
.. attribute:: MemoryBIO.eof

   A boolean indicating whether the memory BIO is current at the end-of-file
   position.

</pre>
</div>
<div class="memorybio system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2556)</p>
<p>Unknown directive type &quot;method&quot;.</p>
<pre class="literal-block">
.. method:: MemoryBIO.read(n=-1)

   Read up to *n* bytes from the memory buffer. If *n* is not specified or
   negative, all bytes are returned.

</pre>
</div>
<div class="memorybio system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2561)</p>
<p>Unknown directive type &quot;method&quot;.</p>
<pre class="literal-block">
.. method:: MemoryBIO.write(buf)

   Write the bytes from *buf* to the memory BIO. The *buf* argument must be an
   object supporting the buffer protocol.

   The return value is the number of bytes written, which is always equal to
   the length of *buf*.

</pre>
</div>
<div class="memorybio system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2569)</p>
<p>Unknown directive type &quot;method&quot;.</p>
<pre class="literal-block">
.. method:: MemoryBIO.write_eof()

   Write an EOF marker to the memory BIO. After this method has been called, it
   is illegal to call :meth:`~MemoryBIO.write`. The attribute :attr:`eof` will
   become true after all data currently in the buffer has been read.
</pre>
</div>
</div>
<div class="section" id="ssl-session">
<h1>SSL session</h1>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2579)</p>
<p>Unknown directive type &quot;versionadded&quot;.</p>
<pre class="literal-block">
.. versionadded:: 3.6

</pre>
</div>
<p class="sslsession">Session object used by <a href="#id294"><span class="problematic" id="id295">:attr:`~SSLSocket.session`</span></a>.</p>
<div class="sslsession system-message" id="id294">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2583); <em><a href="#id295">backlink</a></em></p>
Unknown interpreted text role &quot;attr&quot;.</div>
<div class="sslsession system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2585)</p>
<p>Unknown directive type &quot;attribute&quot;.</p>
<pre class="literal-block">
.. attribute:: id
</pre>
</div>
<div class="sslsession system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2586)</p>
<p>Unknown directive type &quot;attribute&quot;.</p>
<pre class="literal-block">
.. attribute:: time
</pre>
</div>
<div class="sslsession system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2587)</p>
<p>Unknown directive type &quot;attribute&quot;.</p>
<pre class="literal-block">
.. attribute:: timeout
</pre>
</div>
<div class="sslsession system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2588)</p>
<p>Unknown directive type &quot;attribute&quot;.</p>
<pre class="literal-block">
.. attribute:: ticket_lifetime_hint
</pre>
</div>
<div class="sslsession system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2589)</p>
<p>Unknown directive type &quot;attribute&quot;.</p>
<pre class="literal-block">
.. attribute:: has_ticket
</pre>
</div>
</div>
<div class="section" id="security-considerations">
<span id="ssl-security"></span><h1>Security considerations</h1>
<div class="section" id="best-defaults">
<h2>Best defaults</h2>
<p>For <strong>client use</strong>, if you don't have any special requirements for your
security policy, it is highly recommended that you use the
<a href="#id296"><span class="problematic" id="id297">:func:`create_default_context`</span></a> function to create your SSL context.
It will load the system's trusted CA certificates, enable certificate
validation and hostname checking, and try to choose reasonably secure
protocol and cipher settings.</p>
<div class="system-message" id="id296">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2600); <em><a href="#id297">backlink</a></em></p>
Unknown interpreted text role &quot;func&quot;.</div>
<p>For example, here is how you would use the <a href="#id298"><span class="problematic" id="id299">:class:`smtplib.SMTP`</span></a> class to
create a trusted, secure connection to a SMTP server:</p>
<div class="system-message" id="id298">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2607); <em><a href="#id299">backlink</a></em></p>
Unknown interpreted text role &quot;class&quot;.</div>
<pre class="literal-block">
&gt;&gt;&gt; import ssl, smtplib
&gt;&gt;&gt; smtp = smtplib.SMTP(&quot;mail.python.org&quot;, port=587)
&gt;&gt;&gt; context = ssl.create_default_context()
&gt;&gt;&gt; smtp.starttls(context=context)
(220, b'2.0.0 Ready to start TLS')
</pre>
<p>If a client certificate is needed for the connection, it can be added with
<a href="#id300"><span class="problematic" id="id301">:meth:`SSLContext.load_cert_chain`</span></a>.</p>
<div class="system-message" id="id300">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2616); <em><a href="#id301">backlink</a></em></p>
Unknown interpreted text role &quot;meth&quot;.</div>
<p>By contrast, if you create the SSL context by calling the <a href="#id302"><span class="problematic" id="id303">:class:`SSLContext`</span></a>
constructor yourself, it will not have certificate validation nor hostname
checking enabled by default.  If you do so, please read the paragraphs below
to achieve a good security level.</p>
<div class="system-message" id="id302">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2619); <em><a href="#id303">backlink</a></em></p>
Unknown interpreted text role &quot;class&quot;.</div>
</div>
<div class="section" id="manual-settings">
<h2>Manual settings</h2>
<div class="section" id="verifying-certificates">
<h3>Verifying certificates</h3>
<p>When calling the <a href="#id304"><span class="problematic" id="id305">:class:`SSLContext`</span></a> constructor directly,
<a href="#id306"><span class="problematic" id="id307">:const:`CERT_NONE`</span></a> is the default.  Since it does not authenticate the other
peer, it can be insecure, especially in client mode where most of time you
would like to ensure the authenticity of the server you're talking to.
Therefore, when in client mode, it is highly recommended to use
<a href="#id308"><span class="problematic" id="id309">:const:`CERT_REQUIRED`</span></a>.  However, it is in itself not sufficient; you also
have to check that the server certificate, which can be obtained by calling
<a href="#id310"><span class="problematic" id="id311">:meth:`SSLSocket.getpeercert`</span></a>, matches the desired service.  For many
protocols and applications, the service can be identified by the hostname;
in this case, the <a href="#id312"><span class="problematic" id="id313">:func:`match_hostname`</span></a> function can be used.  This common
check is automatically performed when <a href="#id314"><span class="problematic" id="id315">:attr:`SSLContext.check_hostname`</span></a> is
enabled.</p>
<div class="system-message" id="id304">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2630); <em><a href="#id305">backlink</a></em></p>
Unknown interpreted text role &quot;class&quot;.</div>
<div class="system-message" id="id306">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2630); <em><a href="#id307">backlink</a></em></p>
Unknown interpreted text role &quot;const&quot;.</div>
<div class="system-message" id="id308">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2630); <em><a href="#id309">backlink</a></em></p>
Unknown interpreted text role &quot;const&quot;.</div>
<div class="system-message" id="id310">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2630); <em><a href="#id311">backlink</a></em></p>
Unknown interpreted text role &quot;meth&quot;.</div>
<div class="system-message" id="id312">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2630); <em><a href="#id313">backlink</a></em></p>
Unknown interpreted text role &quot;func&quot;.</div>
<div class="system-message" id="id314">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2630); <em><a href="#id315">backlink</a></em></p>
Unknown interpreted text role &quot;attr&quot;.</div>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2643)</p>
<p>Unknown directive type &quot;versionchanged&quot;.</p>
<pre class="literal-block">
.. versionchanged:: 3.7
   Hostname matchings is now performed by OpenSSL. Python no longer uses
   :func:`match_hostname`.

</pre>
</div>
<p>In server mode, if you want to authenticate your clients using the SSL layer
(rather than using a higher-level authentication mechanism), you'll also have
to specify <a href="#id316"><span class="problematic" id="id317">:const:`CERT_REQUIRED`</span></a> and similarly check the client certificate.</p>
<div class="system-message" id="id316">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2647); <em><a href="#id317">backlink</a></em></p>
Unknown interpreted text role &quot;const&quot;.</div>
</div>
<div class="section" id="protocol-versions">
<h3>Protocol versions</h3>
<p>SSL versions 2 and 3 are considered insecure and are therefore dangerous to
use.  If you want maximum compatibility between clients and servers, it is
recommended to use <a href="#id318"><span class="problematic" id="id319">:const:`PROTOCOL_TLS_CLIENT`</span></a> or
<a href="#id320"><span class="problematic" id="id321">:const:`PROTOCOL_TLS_SERVER`</span></a> as the protocol version. SSLv2 and SSLv3 are
disabled by default.</p>
<div class="system-message" id="id318">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2655); <em><a href="#id319">backlink</a></em></p>
Unknown interpreted text role &quot;const&quot;.</div>
<div class="system-message" id="id320">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2655); <em><a href="#id321">backlink</a></em></p>
Unknown interpreted text role &quot;const&quot;.</div>
<pre class="literal-block">
&gt;&gt;&gt; client_context = ssl.SSLContext(ssl.PROTOCOL_TLS_CLIENT)
&gt;&gt;&gt; client_context.options |= ssl.OP_NO_TLSv1
&gt;&gt;&gt; client_context.options |= ssl.OP_NO_TLSv1_1
</pre>
<p>The SSL context created above will only allow TLSv1.2 and later (if
supported by your system) connections to a server. <a href="#id322"><span class="problematic" id="id323">:const:`PROTOCOL_TLS_CLIENT`</span></a>
implies certificate validation and hostname checks by default. You have to
load certificates into the context.</p>
<div class="system-message" id="id322">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2668); <em><a href="#id323">backlink</a></em></p>
Unknown interpreted text role &quot;const&quot;.</div>
</div>
<div class="section" id="cipher-selection">
<h3>Cipher selection</h3>
<p>If you have advanced security requirements, fine-tuning of the ciphers
enabled when negotiating a SSL session is possible through the
<a href="#id324"><span class="problematic" id="id325">:meth:`SSLContext.set_ciphers`</span></a> method.  Starting from Python 3.2.3, the
ssl module disables certain weak ciphers by default, but you may want
to further restrict the cipher choice. Be sure to read OpenSSL's documentation
about the <a class="reference external" href="https://www.openssl.org/docs/manmaster/man1/ciphers.html#CIPHER-LIST-FORMAT">cipher list format</a>.
If you want to check which ciphers are enabled by a given cipher list, use
<a href="#id326"><span class="problematic" id="id327">:meth:`SSLContext.get_ciphers`</span></a> or the <tt class="docutils literal">openssl ciphers</tt> command on your
system.</p>
<div class="system-message" id="id324">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2677); <em><a href="#id325">backlink</a></em></p>
Unknown interpreted text role &quot;meth&quot;.</div>
<div class="system-message" id="id326">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2677); <em><a href="#id327">backlink</a></em></p>
Unknown interpreted text role &quot;meth&quot;.</div>
</div>
</div>
<div class="section" id="multi-processing">
<h2>Multi-processing</h2>
<p>If using this module as part of a multi-processed application (using,
for example the <a href="#id328"><span class="problematic" id="id329">:mod:`multiprocessing`</span></a> or <a href="#id330"><span class="problematic" id="id331">:mod:`concurrent.futures`</span></a> modules),
be aware that OpenSSL's internal random number generator does not properly
handle forked processes.  Applications must change the PRNG state of the
parent process if they use any SSL feature with <a href="#id332"><span class="problematic" id="id333">:func:`os.fork`</span></a>.  Any
successful call of <a href="#id334"><span class="problematic" id="id335">:func:`~ssl.RAND_add`</span></a>, <a href="#id336"><span class="problematic" id="id337">:func:`~ssl.RAND_bytes`</span></a> or
<a href="#id338"><span class="problematic" id="id339">:func:`~ssl.RAND_pseudo_bytes`</span></a> is sufficient.</p>
<div class="system-message" id="id328">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2690); <em><a href="#id329">backlink</a></em></p>
Unknown interpreted text role &quot;mod&quot;.</div>
<div class="system-message" id="id330">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2690); <em><a href="#id331">backlink</a></em></p>
Unknown interpreted text role &quot;mod&quot;.</div>
<div class="system-message" id="id332">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2690); <em><a href="#id333">backlink</a></em></p>
Unknown interpreted text role &quot;func&quot;.</div>
<div class="system-message" id="id334">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2690); <em><a href="#id335">backlink</a></em></p>
Unknown interpreted text role &quot;func&quot;.</div>
<div class="system-message" id="id336">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2690); <em><a href="#id337">backlink</a></em></p>
Unknown interpreted text role &quot;func&quot;.</div>
<div class="system-message" id="id338">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2690); <em><a href="#id339">backlink</a></em></p>
Unknown interpreted text role &quot;func&quot;.</div>
</div>
</div>
<div class="section" id="tls-1-3">
<span id="ssl-tlsv1-3"></span><h1>TLS 1.3</h1>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2704)</p>
<p>Unknown directive type &quot;versionadded&quot;.</p>
<pre class="literal-block">
.. versionadded:: 3.7

</pre>
</div>
<p>Python has provisional and experimental support for TLS 1.3 with OpenSSL
1.1.1.  The new protocol behaves slightly differently than previous version
of TLS/SSL.  Some new TLS 1.3 features are not yet available.</p>
<ul>
<li><p class="first">TLS 1.3 uses a disjunct set of cipher suites. All AES-GCM and
ChaCha20 cipher suites are enabled by default.  The method
<a href="#id340"><span class="problematic" id="id341">:meth:`SSLContext.set_ciphers`</span></a> cannot enable or disable any TLS 1.3
ciphers yet, but <a href="#id342"><span class="problematic" id="id343">:meth:`SSLContext.get_ciphers`</span></a> returns them.</p>
<div class="system-message" id="id340">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2710); <em><a href="#id341">backlink</a></em></p>
<p>Unknown interpreted text role &quot;meth&quot;.</p>
</div>
<div class="system-message" id="id342">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2710); <em><a href="#id343">backlink</a></em></p>
<p>Unknown interpreted text role &quot;meth&quot;.</p>
</div>
</li>
<li><p class="first">Session tickets are no longer sent as part of the initial handshake and
are handled differently.  <a href="#id344"><span class="problematic" id="id345">:attr:`SSLSocket.session`</span></a> and <a href="#id346"><span class="problematic" id="id347">:class:`SSLSession`</span></a>
are not compatible with TLS 1.3.</p>
<div class="system-message" id="id344">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2714); <em><a href="#id345">backlink</a></em></p>
<p>Unknown interpreted text role &quot;attr&quot;.</p>
</div>
<div class="system-message" id="id346">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2714); <em><a href="#id347">backlink</a></em></p>
<p>Unknown interpreted text role &quot;class&quot;.</p>
</div>
</li>
<li><p class="first">Client-side certificates are also no longer verified during the initial
handshake.  A server can request a certificate at any time.  Clients
process certificate requests while they send or receive application data
from the server.</p>
</li>
<li><p class="first">TLS 1.3 features like early data, deferred TLS client cert request,
signature algorithm configuration, and rekeying are not supported yet.</p>
</li>
</ul>
</div>
<div class="section" id="libressl-support">
<span id="ssl-libressl"></span><h1>LibreSSL support</h1>
<p>LibreSSL is a fork of OpenSSL 1.0.1. The ssl module has limited support for
LibreSSL. Some features are not available when the ssl module is compiled
with LibreSSL.</p>
<ul>
<li><p class="first">LibreSSL &gt;= 2.6.1 no longer supports NPN. The methods
<a href="#id348"><span class="problematic" id="id349">:meth:`SSLContext.set_npn_protocols`</span></a> and
<a href="#id350"><span class="problematic" id="id351">:meth:`SSLSocket.selected_npn_protocol`</span></a> are not available.</p>
<div class="system-message" id="id348">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2734); <em><a href="#id349">backlink</a></em></p>
<p>Unknown interpreted text role &quot;meth&quot;.</p>
</div>
<div class="system-message" id="id350">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2734); <em><a href="#id351">backlink</a></em></p>
<p>Unknown interpreted text role &quot;meth&quot;.</p>
</div>
</li>
<li><p class="first"><a href="#id352"><span class="problematic" id="id353">:meth:`SSLContext.set_default_verify_paths`</span></a> ignores the env vars
<a href="#id354"><span class="problematic" id="id355">:envvar:`SSL_CERT_FILE`</span></a> and <a href="#id356"><span class="problematic" id="id357">:envvar:`SSL_CERT_PATH`</span></a> although
<a href="#id358"><span class="problematic" id="id359">:func:`get_default_verify_paths`</span></a> still reports them.</p>
<div class="system-message" id="id352">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2737); <em><a href="#id353">backlink</a></em></p>
<p>Unknown interpreted text role &quot;meth&quot;.</p>
</div>
<div class="system-message" id="id354">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2737); <em><a href="#id355">backlink</a></em></p>
<p>Unknown interpreted text role &quot;envvar&quot;.</p>
</div>
<div class="system-message" id="id356">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2737); <em><a href="#id357">backlink</a></em></p>
<p>Unknown interpreted text role &quot;envvar&quot;.</p>
</div>
<div class="system-message" id="id358">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2737); <em><a href="#id359">backlink</a></em></p>
<p>Unknown interpreted text role &quot;func&quot;.</p>
</div>
</li>
</ul>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">ssl.rst</tt>, line 2742)</p>
<p>Unknown directive type &quot;seealso&quot;.</p>
<pre class="literal-block">
.. seealso::

   Class :class:`socket.socket`
       Documentation of underlying :mod:`socket` class

   `SSL/TLS Strong Encryption: An Introduction &lt;https://httpd.apache.org/docs/trunk/en/ssl/ssl_intro.html&gt;`_
       Intro from the Apache HTTP Server documentation

   :rfc:`RFC 1422: Privacy Enhancement for Internet Electronic Mail: Part II: Certificate-Based Key Management &lt;1422&gt;`
       Steve Kent

   :rfc:`RFC 4086: Randomness Requirements for Security &lt;4086&gt;`
       Donald E., Jeffrey I. Schiller

   :rfc:`RFC 5280: Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile &lt;5280&gt;`
       D. Cooper

   :rfc:`RFC 5246: The Transport Layer Security (TLS) Protocol Version 1.2 &lt;5246&gt;`
       T. Dierks et. al.

   :rfc:`RFC 6066: Transport Layer Security (TLS) Extensions &lt;6066&gt;`
       D. Eastlake

   `IANA TLS: Transport Layer Security (TLS) Parameters &lt;https://www.iana.org/assignments/tls-parameters/tls-parameters.xml&gt;`_
       IANA

   :rfc:`RFC 7525: Recommendations for Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS) &lt;7525&gt;`
       IETF

   `Mozilla's Server Side TLS recommendations &lt;https://wiki.mozilla.org/Security/Server_Side_TLS&gt;`_
       Mozilla
</pre>
</div>
</div>
</div>
</body>
</html>
